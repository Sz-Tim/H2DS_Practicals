<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.40">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>3&nbsp; Normal distribution – H2 Data Science Practicals</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./P4_t_CIs.html" rel="next">
<link href="./P2_binomial_poisson.html" rel="prev">
<link href="./figs/one_distribution.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-549806ee2085284f45b00abea8c6df48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-d5d78c9e45e9a5253a6059031ce5ea1b.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/quarto-contrib/foldbox/foldbox.css" rel="stylesheet"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><style>
.Q. {
  --color1: #69B7CE;
  --color2: #3F6F76;
}
</style>
<script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>
</head>
<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./P3_normal.html"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Normal distribution</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">H2 Data Science Practicals</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/Sz-Tim/H2DS_Practicals" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
    <div class="dropdown">
      <a href="" title="Download" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" role="link" aria-label="Download"><i class="bi bi-download"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
<li>
            <a class="dropdown-item sidebar-tools-main-item" href="./H2-Data-Science-Practicals.pdf">
              <i class="bi bi-file-pdf pe-1"></i>
            Download PDF
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="./H2-Data-Science-Practicals.epub">
              <i class="bi bi-journal pe-1"></i>
            Download ePub
            </a>
          </li>
      </ul>
</div>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./P0_R_setup.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">R setup</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./P1_R_recap.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">R recap</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./P2_binomial_poisson.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Binomial and Poisson distributions</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./P3_normal.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Normal distribution</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./P4_t_CIs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">The t-distribution and confidence intervals</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./P5_ANOVA_regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">ANOVA and regression</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./P6_machine_learning.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Machine Learning</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./P7_appendix.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Appendix</span></span></a>
  </div>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li>
<a href="#using-the-normal-distribution" id="toc-using-the-normal-distribution" class="nav-link active" data-scroll-target="#using-the-normal-distribution"><span class="header-section-number">3.1</span> Using the normal distribution</a>
  <ul class="collapse">
<li><a href="#using-r-to-calculate-areas-under-the-normal-curve" id="toc-using-r-to-calculate-areas-under-the-normal-curve" class="nav-link" data-scroll-target="#using-r-to-calculate-areas-under-the-normal-curve"><span class="header-section-number">3.1.1</span> Using R to calculate areas under the normal curve</a></li>
  </ul>
</li>
  <li><a href="#normal-model-adequacy" id="toc-normal-model-adequacy" class="nav-link" data-scroll-target="#normal-model-adequacy"><span class="header-section-number">3.2</span> Normal model adequacy</a></li>
  <li><a href="#quantiles" id="toc-quantiles" class="nav-link" data-scroll-target="#quantiles"><span class="header-section-number">3.3</span> Quantiles</a></li>
  <li><a href="#testing-for-normality" id="toc-testing-for-normality" class="nav-link" data-scroll-target="#testing-for-normality"><span class="header-section-number">3.4</span> Testing for normality</a></li>
  <li><a href="#transformations" id="toc-transformations" class="nav-link" data-scroll-target="#transformations"><span class="header-section-number">3.5</span> Data transformations</a></li>
  <li>
<a href="#the-central-limit-theorem" id="toc-the-central-limit-theorem" class="nav-link" data-scroll-target="#the-central-limit-theorem"><span class="header-section-number">3.6</span> The Central Limit Theorem</a>
  <ul class="collapse">
<li><a href="#the-distribution-of-means-from-non-normal-data" id="toc-the-distribution-of-means-from-non-normal-data" class="nav-link" data-scroll-target="#the-distribution-of-means-from-non-normal-data"><span class="header-section-number">3.6.1</span> The distribution of means from non-normal data</a></li>
  </ul>
</li>
  <li><a href="#the-standard-error-of-the-mean" id="toc-the-standard-error-of-the-mean" class="nav-link" data-scroll-target="#the-standard-error-of-the-mean"><span class="header-section-number">3.7</span> The standard error of the mean</a></li>
  <li>
<a href="#normal-approximations" id="toc-normal-approximations" class="nav-link" data-scroll-target="#normal-approximations"><span class="header-section-number">3.8</span> Normal approximations</a>
  <ul class="collapse">
<li><a href="#the-normal-approximation-of-the-poisson-distribution" id="toc-the-normal-approximation-of-the-poisson-distribution" class="nav-link" data-scroll-target="#the-normal-approximation-of-the-poisson-distribution"><span class="header-section-number">3.8.1</span> The Normal approximation of the Poisson distribution</a></li>
  <li><a href="#the-normal-approximation-of-the-binomial-distribution" id="toc-the-normal-approximation-of-the-binomial-distribution" class="nav-link" data-scroll-target="#the-normal-approximation-of-the-binomial-distribution"><span class="header-section-number">3.8.2</span> The Normal approximation of the binomial distribution</a></li>
  </ul>
</li>
  <li><a href="#conclusions" id="toc-conclusions" class="nav-link" data-scroll-target="#conclusions"><span class="header-section-number">3.9</span> Conclusions</a></li>
  </ul><div class="toc-actions"><ul><li><a href="https://github.com/Sz-Tim/H2DS_Practicals/issues/new" class="toc-action"><i class="bi bi-github"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title"><span id="sec-P3" class="quarto-section-identifier"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Normal distribution</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><p>Statistical inference is the process by which we infer from a sample statistic to the population. We need to infer from samples to populations because it is usually impossible to measure the entire population. Inference is the process of estimating population parameters from a sample.</p>
<p>In order to infer from samples to populations we need to understand how the statistics we generate from our samples are likely to ‘behave’. To do this we use theoretical distributions.</p>
<div id="Q.-3.1" class="Q.">
<p></p><details class="Q. fbx-simplebox fbx-default" open=""><summary><strong>Q. 3.1</strong></summary><div>Which two theoretical distributions have we already covered?
</div></details><p></p>
</div>
<p>The normal (a.k.a., Gaussian) distribution is a theoretical distribution that is central to inferential statistics. If your data (or, more accurately, statistics derived from you data) are reasonably approximated by the normal distribution then you will be able to use a wide range of techniques to deal with it.</p>
<p>In this practical we will examine the normal distribution, calculate Z scores, and interpret those Z scores. We’ll assess whether data are reasonably assumed to be normally distributed, transforming the data where they are not. We’ll apply the CLT and evaluate how well other distributions are approximated by the normal distribution.</p>
<div class="cell">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://readxl.tidyverse.org">readxl</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">2025</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
<section id="using-the-normal-distribution" class="level2" data-number="3.1"><h2 data-number="3.1" class="anchored" data-anchor-id="using-the-normal-distribution">
<span class="header-section-number">3.1</span> Using the normal distribution</h2>
<p>The length of a catch of herring was measured. Five hundred individuals were studied. We will consider this group to be the entire population of interest. The population parameters are: <span class="math inline">\(\mu = 37.6 cm\)</span> and <span class="math inline">\(\sigma = 1.20 cm\)</span>.</p>
<div id="Q.-3.2" class="Q.">
<p></p><details class="Q. fbx-simplebox fbx-default" open=""><summary><strong>Q. 3.2</strong></summary><div>What are the theoretical limits of the normal distribution?
</div></details><p></p>
</div>
<div id="Q.-3.3" class="Q.">
<p></p><details class="Q. fbx-simplebox fbx-default" open=""><summary><strong>Q. 3.3</strong></summary><div>Do you think normality a fair assumption for these data?
</div></details><p></p>
</div>
<div id="Q.-3.4" class="Q.">
<p></p><details class="Q. fbx-simplebox fbx-default" open=""><summary><strong>Q. 3.4</strong></summary><div>Assume herring length is approximately normally distributed and write down the model which describes the fish length distribution: <span class="math inline">\(y_i \sim Norm(\mu, \sigma)\)</span>.
</div></details><p></p>
</div>
<p>If we know the population parameters, we can calculate Z scores for individuals (or groups of individuals) from that population and calculate how unusual they are. For the moment, we are interested in determining what proportion of fish from this population are expected to be &lt; 38 cm.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">mu</span> <span class="op">&lt;-</span> <span class="fl">37.6</span></span>
<span><span class="va">sigma</span> <span class="op">&lt;-</span> <span class="fl">1.2</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fl">38</span></span>
<span></span>
<span><span class="va">y_lt38_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>len<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="va">mu</span><span class="op">-</span><span class="fl">3</span><span class="op">*</span><span class="va">sigma</span>, <span class="va">mu</span><span class="op">+</span><span class="fl">3</span><span class="op">*</span><span class="va">sigma</span>, length.out<span class="op">=</span><span class="fl">1e3</span><span class="op">)</span>,</span>
<span>                     density<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="va">len</span>, <span class="va">mu</span>, <span class="va">sigma</span><span class="op">)</span>,</span>
<span>                     shade<span class="op">=</span><span class="va">len</span> <span class="op">&lt;</span> <span class="fl">38</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">y_lt38_df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">len</span>, ymin<span class="op">=</span><span class="fl">0</span>, ymax<span class="op">=</span><span class="va">density</span>, fill<span class="op">=</span><span class="va">shade</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html">geom_ribbon</a></span><span class="op">(</span>colour<span class="op">=</span><span class="st">"grey30"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span><span class="op">(</span>values<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"white"</span>, <span class="st">"red3"</span><span class="op">)</span>, guide<span class="op">=</span><span class="st">"none"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x<span class="op">=</span><span class="st">"Herring length (cm)"</span>, y<span class="op">=</span><span class="st">"Probability density"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_classic</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div id="fig-normal_herring" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-normal_herring-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="P3_normal_files/figure-html/fig-normal_herring-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-normal_herring-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.1: Normal distribution of herring lengths.
</figcaption></figure>
</div>
</div>
</div>
<section id="using-r-to-calculate-areas-under-the-normal-curve" class="level3" data-number="3.1.1"><h3 data-number="3.1.1" class="anchored" data-anchor-id="using-r-to-calculate-areas-under-the-normal-curve">
<span class="header-section-number">3.1.1</span> Using R to calculate areas under the normal curve</h3>
<p>To solve this problem using R we use the cumulative probability. Observations at the extreme low end are extremely unlikely, but the probability of observing data increases and reaches a maximum at the mean, after which it declines again. The normal distribution is symmetrical.</p>
<div id="Q.-3.5" class="Q.">
<p></p><details class="Q. fbx-simplebox fbx-default" open=""><summary><strong>Q. 3.5</strong></summary><div>What shape is the cumulative probability curve of a normally distributed variable?
</div></details><p></p>
</div>
<p>The R functions for the normal distribution take the same form as those for the binomial and Poisson distributions. To calculate the probability is of observing a fish less than 38 cm, you need to specify the model and select the appropriate distribution function. Use <code><a href="https://rdrr.io/r/stats/Normal.html">?dnorm</a></code> or <code><a href="https://rdrr.io/r/stats/Normal.html">?pnorm</a></code> and look at your options (<a href="#fig-dpq_examp" class="quarto-xref">Figure&nbsp;<span>3.2</span></a>).</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://wilkelab.org/cowplot/">cowplot</a></span><span class="op">)</span></span>
<span><span class="va">norm_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>x<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">4</span>, <span class="fl">4</span>, length.out<span class="op">=</span><span class="fl">1e3</span><span class="op">)</span>,</span>
<span>                  x2<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, length.out<span class="op">=</span><span class="fl">1e3</span><span class="op">)</span>,</span>
<span>                  lo<span class="op">=</span><span class="fl">0</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>d<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, </span>
<span>         q<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span><span class="op">(</span><span class="va">x2</span><span class="op">)</span>,</span>
<span>         p<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">pnorm</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,</span>
<span>         above_m1<span class="op">=</span><span class="va">x</span> <span class="op">&gt;</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span> </span>
<span><span class="va">labels_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html">tribble</a></span><span class="op">(</span><span class="op">~</span><span class="va">x</span>, <span class="op">~</span><span class="va">y</span>, <span class="op">~</span><span class="va">label</span>,</span>
<span>                     <span class="op">-</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span>, <span class="st">"dnorm(-1) = 0.242  "</span>,</span>
<span>                     <span class="op">-</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="st">" qnorm(0.158) = -1"</span><span class="op">)</span></span>
<span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">norm_df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html">geom_ribbon</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>ymin<span class="op">=</span><span class="va">lo</span>, ymax<span class="op">=</span><span class="va">d</span>, fill<span class="op">=</span><span class="va">above_m1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y<span class="op">=</span><span class="va">d</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">labels_df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y<span class="op">=</span><span class="va">y</span><span class="op">)</span>, size<span class="op">=</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">labels_df</span><span class="op">[</span><span class="fl">1</span>,<span class="op">]</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y<span class="op">=</span><span class="va">y</span>, label<span class="op">=</span><span class="va">label</span><span class="op">)</span>, hjust<span class="op">=</span><span class="fl">1</span>, size<span class="op">=</span><span class="fl">3</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">labels_df</span><span class="op">[</span><span class="fl">2</span>,<span class="op">]</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y<span class="op">=</span><span class="va">y</span>, label<span class="op">=</span><span class="va">label</span><span class="op">)</span>, size<span class="op">=</span><span class="fl">3</span>,</span>
<span>            hjust<span class="op">=</span><span class="fl">0</span>, vjust<span class="op">=</span><span class="fl">0</span>, nudge_y<span class="op">=</span><span class="fl">0.01</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span><span class="op">(</span><span class="st">""</span>, values<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"red3"</span>, <span class="st">"white"</span><span class="op">)</span>, </span>
<span>                    labels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"pnorm(-1) = 0.158"</span>, <span class="st">""</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x<span class="op">=</span><span class="st">"Value"</span>, y<span class="op">=</span><span class="st">"Density"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_classic</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.8</span>, <span class="fl">0.8</span><span class="op">)</span>,</span>
<span>        legend.text<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">8</span><span class="op">)</span>,</span>
<span>        legend.key.size<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fl">0.3</span>, <span class="st">"cm"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">norm_df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">d</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x<span class="op">=</span><span class="st">"Value"</span>, y<span class="op">=</span><span class="st">"dnorm(Value, 0, 1)"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_classic</a></span><span class="op">(</span><span class="op">)</span> </span>
<span><span class="va">p3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">norm_df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">p</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x<span class="op">=</span><span class="st">"Value"</span>, y<span class="op">=</span><span class="st">"pnorm(Value, 0, 1)"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_classic</a></span><span class="op">(</span><span class="op">)</span> </span>
<span><span class="va">p4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">norm_df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">x2</span>, <span class="va">q</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x<span class="op">=</span><span class="st">"Probability"</span>, y<span class="op">=</span><span class="st">"qnorm(Probability, 0, 1)"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_classic</a></span><span class="op">(</span><span class="op">)</span> </span>
<span></span>
<span><span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html">plot_grid</a></span><span class="op">(</span><span class="va">p1</span>, <span class="va">p2</span>, <span class="va">p3</span>, <span class="va">p4</span>, align<span class="op">=</span><span class="st">"hv"</span>, axis<span class="op">=</span><span class="st">"tblr"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div id="fig-dpq_examp" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-dpq_examp-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="P3_normal_files/figure-html/fig-dpq_examp-1.png" class="img-fluid figure-img" width="768">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-dpq_examp-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.2: Functions for distributions in R illustrated with a standard normal.
</figcaption></figure>
</div>
</div>
</div>
<p>To calculate <span class="math inline">\(P(y_i &lt; 38 | \mu = 37.6, \sigma = 1.2)\)</span>, we use <code><a href="https://rdrr.io/r/stats/Normal.html">pnorm()</a></code>, which gives the cumulative probability from <code>-Inf</code> to the value we choose.</p>
<div class="cell">
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># cumulative probability: which bit of the curve does this relate to?</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">pnorm</a></span><span class="op">(</span>q <span class="op">=</span> <span class="fl">38</span>, mean <span class="op">=</span> <span class="fl">37.6</span>, sd <span class="op">=</span> <span class="fl">1.2</span><span class="op">)</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="Q.-3.6" class="Q.">
<p></p><details class="Q. fbx-simplebox fbx-default" open=""><summary><strong>Q. 3.6</strong></summary><div>What is the probability of a randomly selected fish from this population being less than 35 cm?
</div></details><p></p>
</div>
<div id="Q.-3.7" class="Q.">
<p></p><details class="Q. fbx-simplebox fbx-default" open=""><summary><strong>Q. 3.7</strong></summary><div>What proportion of individuals are greater than 39 cm?
</div></details><p></p>
</div>
<p>We can plot any normal distribution we like. Play with the values for <code>mu</code> and <code>sigma</code> below, adjusting the values for <code>from</code> and <code>to</code> as needed to see the distribution.</p>
<div class="cell">
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">mu</span> <span class="op">&lt;-</span> <span class="fl">37.6</span>  <span class="co"># population mean</span></span>
<span><span class="va">sigma</span> <span class="op">&lt;-</span> <span class="fl">1.2</span>  <span class="co"># population sd</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/curve.html">curve</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="va">x</span>, mean <span class="op">=</span> <span class="va">mu</span>, sd <span class="op">=</span> <span class="va">sigma</span><span class="op">)</span>, from <span class="op">=</span> <span class="fl">30</span>, to <span class="op">=</span> <span class="fl">45</span>,</span>
<span>      main <span class="op">=</span> <span class="st">"Normal density"</span>, ylab <span class="op">=</span> <span class="st">"Density"</span>, xlab <span class="op">=</span> <span class="st">"Fish length, cm"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr></section></section><section id="normal-model-adequacy" class="level2" data-number="3.2"><h2 data-number="3.2" class="anchored" data-anchor-id="normal-model-adequacy">
<span class="header-section-number">3.2</span> Normal model adequacy</h2>
<p>In a population of long-eared wrasse, we calculate <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma\)</span> and find <span class="math inline">\(y \sim Norm(15.2 cm, 25.1 cm)\)</span>.</p>
<div id="Q.-3.8" class="Q.">
<p></p><details class="Q. fbx-simplebox fbx-default" open=""><summary><strong>Q. 3.8</strong></summary><div>What is the mean length and standard deviation of long-eared wrasse?
</div></details><p></p>
</div>
<div id="Q.-3.9" class="Q.">
<p></p><details class="Q. fbx-simplebox fbx-default" open=""><summary><strong>Q. 3.9</strong></summary><div>Calculate the proportion of fish that are expected to be less than zero cm in length.
</div></details><p></p>
</div>
<div id="Q.-3.10" class="Q.">
<p></p><details class="Q. fbx-simplebox fbx-default" open=""><summary><strong>Q. 3.10</strong></summary><div>What do your results indicate about the adequacy of the normal model to describe the length distribution of long-eared wrasse?
</div></details><p></p>
</div>
<div id="Q.-3.11" class="Q.">
<p></p><details class="Q. fbx-simplebox fbx-default" open=""><summary><strong>Q. 3.11</strong></summary><div>Would your conclusions change if <span class="math inline">\(\sigma\)</span> were smaller? For example: <span class="math inline">\(y \sim Norm(15.2, 2.51)\)</span>.
</div></details><p></p>
</div>
<hr></section><section id="quantiles" class="level2" data-number="3.3"><h2 data-number="3.3" class="anchored" data-anchor-id="quantiles">
<span class="header-section-number">3.3</span> Quantiles</h2>
<p>A quantile is a value that divides a frequency distribution (i.e.&nbsp;a set of numbers) into equally represented groups (i.e., the same number of observations per group). For example, there are three values (Q1, Q2, Q3) that split a normal distribution into four groups (negative infinity to Q1, Q1 to Q2 (median), Q2 to Q3, and Q3 to positive infinity). Q3 - Q1 is the middle 50% of the data: the interquartile range.</p>
<p>There are 99 quantiles, called percentiles, that split your data into 100 groups. The 2.5 percentile is the value that splits your data into two groups corresponding to 2.5% along the distribution (from negative infinity for the normal distribution). Just as we can ask what proportion of a distribution is above or below a set value, we can also ask between which values will a given percentage of my data lie (e.g.&nbsp;what values correspond to the middle 95%?).</p>
<p>To solve this problem using R we use the quantile function <code><a href="https://rdrr.io/r/stats/Normal.html">qnorm()</a></code>, speciying the cumulative probability as an argument. To find the value that splits the upper 2.5%:</p>
<div class="cell">
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span><span class="op">(</span>p <span class="op">=</span> <span class="fl">0.975</span>, mean <span class="op">=</span> <span class="fl">37.6</span>, sd <span class="op">=</span> <span class="fl">1.2</span><span class="op">)</span> <span class="co"># p is the cumulative probability </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 39.95196</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">probs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fl">0.1</span>, to <span class="op">=</span> <span class="fl">0.9</span>, by <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span> <span class="co"># vectorize for multiple values</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">probs</span>, quantiles<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span><span class="op">(</span>p <span class="op">=</span> <span class="va">probs</span>, mean <span class="op">=</span> <span class="fl">37.6</span>, sd <span class="op">=</span> <span class="fl">1.2</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              [,1]     [,2] [,3]     [,4]     [,5]
probs      0.10000  0.30000  0.5  0.70000  0.90000
quantiles 36.06214 36.97072 37.6 38.22928 39.13786</code></pre>
</div>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span><span class="op">(</span>p <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.025</span>, <span class="fl">0.975</span><span class="op">)</span>, mean <span class="op">=</span> <span class="fl">37.6</span>, sd <span class="op">=</span> <span class="fl">1.2</span><span class="op">)</span> <span class="co"># middle 95%</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 35.24804 39.95196</code></pre>
</div>
</div>
<p>These values (<code>c(0.025, 0.975)</code>) identify proportions of the cumulative curve. That is, they identify the bottom 2.5% and the bottom 97.5% of the curve. Values between these two parameters constitute the central 95% of your data.</p>
<p>We quote our mean and interval like this:</p>
<blockquote class="blockquote">
<p>The mean fish length and 95% interval was 37.6 cm (35.2 – 40.0 cm).</p>
</blockquote>
<p>Remember to use to same degree of precision (significant figures) for confidence intervals as was used to gather the data (or as specified in the question, defaulting to three).</p>
<div id="Q.-3.12" class="Q.">
<p></p><details class="Q. fbx-simplebox fbx-default" open=""><summary><strong>Q. 3.12</strong></summary><div>Find the values that capture the middle 90% of the herring data, where <span class="math inline">\(y \sim Norm(37.6, 1.2)\)</span>.
</div></details><p></p>
</div>
<div id="Q.-3.13" class="Q.">
<p></p><details class="Q. fbx-simplebox fbx-default" open=""><summary><strong>Q. 3.13</strong></summary><div>What value would you expect to correspond to <code>p=0.5</code>?
</div></details><p></p>
</div>
<div id="Q.-3.14" class="Q.">
<p></p><details class="Q. fbx-simplebox fbx-default" open=""><summary><strong>Q. 3.14</strong></summary><div>Check your answer above using <code><a href="https://rdrr.io/r/stats/Normal.html">qnorm()</a></code>.
</div></details><p></p>
</div>
<p>To visualize regions of the normal distribution, let’s use <em>ggplot</em>.</p>
<div class="cell">
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">mu</span> <span class="op">&lt;-</span> <span class="fl">37.6</span></span>
<span><span class="va">sigma</span> <span class="op">&lt;-</span> <span class="fl">1.2</span></span>
<span><span class="va">lb</span> <span class="op">&lt;-</span> <span class="fl">36</span> <span class="co"># lower boundary </span></span>
<span><span class="va">ub</span> <span class="op">&lt;-</span> <span class="fl">40</span> <span class="co"># upper boundary</span></span>
<span></span>
<span><span class="va">norm_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>z<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">4</span>, <span class="fl">4</span>, length.out<span class="op">=</span><span class="fl">1000</span><span class="op">)</span>,</span>
<span>                  x<span class="op">=</span><span class="va">z</span><span class="op">*</span><span class="va">sigma</span> <span class="op">+</span> <span class="va">mu</span>,</span>
<span>                  densNorm<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">mu</span>, <span class="va">sigma</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">norm_df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">densNorm</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html">geom_ribbon</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">norm_df</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">x</span> <span class="op">&gt;</span> <span class="va">lb</span> <span class="op">&amp;</span> <span class="va">x</span> <span class="op">&lt;</span> <span class="va">ub</span><span class="op">)</span>,</span>
<span>              <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>ymin<span class="op">=</span><span class="fl">0</span>, ymax<span class="op">=</span><span class="va">densNorm</span><span class="op">)</span>, fill<span class="op">=</span><span class="st">"steelblue"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x<span class="op">=</span><span class="st">"Herring length (cm)"</span>, </span>
<span>       y<span class="op">=</span><span class="st">"Probability density"</span>,</span>
<span>       subtitle<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"P("</span>, <span class="va">lb</span>, <span class="st">"&lt; y &lt;"</span>, <span class="va">ub</span>, <span class="st">") = "</span>, </span>
<span>                       <span class="fu"><a href="https://rdrr.io/r/base/Round.html">signif</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">pnorm</a></span><span class="op">(</span><span class="va">ub</span>, <span class="va">mu</span>, <span class="va">sigma</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">pnorm</a></span><span class="op">(</span><span class="va">lb</span>, <span class="va">mu</span>, <span class="va">sigma</span><span class="op">)</span>, digits<span class="op">=</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_classic</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># changes how the plot looks: ?theme</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-herring2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-herring2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="P3_normal_files/figure-html/fig-herring2-1.png" class="img-fluid figure-img" width="576">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-herring2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.3: The normal distribution illustrating probability of a random herring from your population having a length between 36 and 40 cm.
</figcaption></figure>
</div>
</div>
</div>
<div id="Q.-3.15" class="Q.">
<p></p><details class="Q. fbx-simplebox fbx-default" open=""><summary><strong>Q. 3.15</strong></summary><div>Change the parameters in code the above to check that the values you generated for the 95% interval correspond when plugged into <code>lb</code> and <code>ub</code> in the code.
</div></details><p></p>
</div>
<div id="Q.-3.16" class="Q.">
<p></p><details class="Q. fbx-simplebox fbx-default" open=""><summary><strong>Q. 3.16</strong></summary><div>What is the difference between <span class="math inline">\(&lt; x\)</span> and <span class="math inline">\(\leq x\)</span> when applied to continuous data?
</div></details><p></p>
</div>
<div id="Q.-3.17" class="Q.">
<p></p><details class="Q. fbx-simplebox fbx-default" open=""><summary><strong>Q. 3.17</strong></summary><div>Does this also apply to discontinuous data?
</div></details><p></p>
</div>
<p>How would you expect these intervals to change when the population standard deviation <span class="math inline">\(\sigma\)</span> changes?</p>
<div id="Q.-3.18" class="Q.">
<p></p><details class="Q. fbx-simplebox fbx-default" open=""><summary><strong>Q. 3.18</strong></summary><div>With everything else equal, try doubling, quadrupling, and halving the standard deviation on the herring data then re-running the same code.
</div></details><p></p>
</div>
<div id="Q.-3.19" class="Q.">
<p></p><details class="Q. fbx-simplebox fbx-default" open=""><summary><strong>Q. 3.19</strong></summary><div>Does the change in the 95% interval match your expectations?
</div></details><p></p>
</div>
<p>A z score gives the number of standard deviations away from the mean for any value. The z score is the value from the standard normal distribution (<span class="math inline">\(\mu = 0, \sigma = 1\)</span>) that corresponds with the same quantile of the original distribution. The values for any normal distribution can be converted to Z scores by subtracting <span class="math inline">\(\mu\)</span> and dividing by <span class="math inline">\(\sigma\)</span>, such that <span class="math inline">\(z_i = \frac{y_i - \mu}{\sigma}\)</span></p>
<div id="Q.-3.20" class="Q.">
<p></p><details class="Q. fbx-simplebox fbx-default" open=""><summary><strong>Q. 3.20</strong></summary><div>With <span class="math inline">\(y \sim Norm(37.6, 1.2)\)</span>, what is the z score for an individual of length 34?
</div></details><p></p>
</div>
<hr></section><section id="testing-for-normality" class="level2" data-number="3.4"><h2 data-number="3.4" class="anchored" data-anchor-id="testing-for-normality">
<span class="header-section-number">3.4</span> Testing for normality</h2>
<p>Many statistical tests assume that data are reasonably approximated by a normal distribution and have homogeneous variance. R can be used to formally test the assumption that data are normally distributed, though you should have some idea of whether this is likely through consideration of the data source. This applies particularly where you have a small sample size which makes evaluating the distribution challenging.</p>
<p>The data you collect will be part of a population. The normality check assesses the viability of the assumption that the data you collected were drawn from a population that was normally distributed. Note that populations are, in practice, <em>never</em> actually normally distributed. Your test is to assess how <em>reasonable</em> the assumption of normality is.</p>
<div class="cell">
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">MS</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_xlsx</a></span><span class="op">(</span><span class="st">"data/H2DS_practicalData.xlsx"</span>, sheet <span class="op">=</span> <span class="st">"Mood shrimp"</span><span class="op">)</span></span>
<span><span class="co"># check the data using head(), str() etc.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We’ll learn more advanced methods in <a href="P5_ANOVA_regression.html" class="quarto-xref"><span>Chapter 5</span></a> for the analyses we cover, but we can plot how well our observations follow the expectations of a normal distribution with <code><a href="https://rdrr.io/r/stats/qqnorm.html">qqnorm()</a></code> and add a line of perfect fit with <code><a href="https://rdrr.io/r/stats/qqnorm.html">qqline()</a></code>.</p>
<div class="cell">
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/qqnorm.html">qqnorm</a></span><span class="op">(</span><span class="va">MS</span><span class="op">$</span><span class="va">Shrimp1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/qqnorm.html">qqline</a></span><span class="op">(</span><span class="va">MS</span><span class="op">$</span><span class="va">Shrimp1</span>, col <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="co"># the data fall near the line</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/qqnorm.html">qqnorm</a></span><span class="op">(</span><span class="va">MS</span><span class="op">$</span><span class="va">Shrimp2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/qqnorm.html">qqline</a></span><span class="op">(</span><span class="va">MS</span><span class="op">$</span><span class="va">Shrimp2</span>, col <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="co"># the data deviate widely from the line</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="P3_normal_files/figure-html/qq-examp-1.png" class="img-fluid figure-img" width="768"></p>
<figcaption>Normal (QQ) plots. The left indicates that the normality assumption might be reasonable, not so on the right.</figcaption></figure>
</div>
</div>
</div>
<p>The axes are automatically scaled so that perfectly normally distributed data would fall on a diagonal line. Any deviation from the red straight line indicates a lack of normality. What we need to assess is how serious any deviation is and whether it is sufficient to indicate that the assumption of normality is not ‘reasonable’. This is a subjective decision, and two different statisticians may tell you different answers about the same data.</p>
<p>As sample size decreases, it becomes increasingly difficult to see if your data are reasonably approximated by a normal distribution. There are many formal statistical methods for assessing normality, but as we already know, it is impossible for a population to be distributed perfectly normally and this means such tests are largely redundant. You must assess the assumptions of your model, but you should be aware that all data fails the assumptions. The question is whether the assumptions are <em>reasonably</em> well met such that the model results can be useful. There is sadly no hard rule as to what constitutes ‘reasonable’!</p>
<div id="Q.-3.21" class="Q.">
<p></p><details class="Q. fbx-simplebox fbx-default" open=""><summary><strong>Q. 3.21</strong></summary><div>Make histograms of both <code>Shrimp1</code> and <code>Shrimp2</code>. Comment on their apparent distributions.
</div></details><p></p>
</div>
<hr></section><section id="transformations" class="level2" data-number="3.5"><h2 data-number="3.5" class="anchored" data-anchor-id="transformations">
<span class="header-section-number">3.5</span> Data transformations</h2>
<p>The assumption that our sample data are drawn from a normally distributed population is central to the use of many important inferential statistical techniques. However, frequently it is <em>not</em> reasonable to assume that data are approximately normally distributed.</p>
<p>A common issue is that our measurements are logically bounded. For example, chemical concentrations (e.g., zinc in sediments) cannot be negative. Similarly, you cannot have negative lengths, time, mass, etc. Proportions must be between 0 and 1. Where data is collected ‘near’ a logical boundary they are often not normally distributed, since the normal distribution predicts ‘tails’ which are impossible.</p>
<p>One solution is to use a mathematical transformation to convert your data to something that is reasonably approximated by a normal distribution even if it is not well approximated in the original measurement units. Often transformations will also correct unequal variances (see <a href="P5_ANOVA_regression.html" class="quarto-xref"><span>Chapter 5</span></a>) in addition to non-normality so they are very useful. The appropriate transformation depends on the data.</p>
<p>Common transformations include:</p>
<ul>
<li>Log (<code>log(x)</code>, inverse: <code>exp(x)</code>): When the distribution is skewed right and all values are &gt;0. Often ‘cures’ heteroscedasticity. Commonly used for observations spanning orders of magnitude such as body size.<br>
</li>
<li>Square-root (<code>sqrt(x)</code>, inverse: <code>x^2</code>): When the measurements are areas (e.g., leaf areas). Often used to ‘down-weight’ common species (e.g., <a href="P6_machine_learning.html" class="quarto-xref"><span>Chapter 6</span></a>), which is unrelated to model assumptions. Values must be &gt;0.<br>
</li>
<li>Arcsine (<code>asin(x)</code>, inverse: <code>sin(x)^2</code>): When the measurements are proportions. Tends to stretch out the tails (e.g., near 0 or 1 for proportions) and squash the middle (e.g., near 0.5).<br>
</li>
<li>Logit (<code>boot::logit(x)</code>, inverse: <code>boot::inv.logit(x)</code>): Used for proportions excluding 0 and 1. Also commonly used in models with a binary (Bernoulli) response variable (e.g., survival probability predicted by temperature, where the response variable is ‘alive’/‘dead’).</li>
<li>Reciprocal (<code>1/x</code>, inverse: <code>1/x</code>): When the distribution is skewed right. Generally ‘stronger’ than a log transformation and often has logically interpretable units (<span class="math inline">\(m~s^{-1}\)</span>, <span class="math inline">\(s~m^{-1}\)</span>).<br>
</li>
</ul>
<p>Identifying the correct transformation can be led by an underlying comprehension of the nature of the data. However, this often doesn’t work so expect some trial and error.</p>
<p>We can visualize the relationship between data on the original scale and the transformed values. For values bounded by 0:</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">positive_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>orig<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0.01</span>, <span class="fl">10</span>, length.out<span class="op">=</span><span class="fl">1e3</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>sqrt<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">orig</span><span class="op">)</span>,</span>
<span>         ln<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">orig</span><span class="op">)</span>,</span>
<span>         reciprocal<span class="op">=</span><span class="fl">1</span><span class="op">/</span><span class="va">orig</span>,</span>
<span>         squared<span class="op">=</span><span class="va">orig</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span>cols<span class="op">=</span><span class="fl">2</span><span class="op">:</span><span class="fl">5</span>, names_to<span class="op">=</span><span class="st">"transformation"</span>, values_to<span class="op">=</span><span class="st">"new_value"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">positive_df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">orig</span>, <span class="va">new_value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">transformation</span>, scales<span class="op">=</span><span class="st">"free"</span>, nrow<span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>main<span class="op">=</span><span class="st">"Positive values"</span>, x<span class="op">=</span><span class="st">"Original value"</span>, y<span class="op">=</span><span class="st">"Transformed value"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div id="fig-trans_positiveData" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-trans_positiveData-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="P3_normal_files/figure-html/fig-trans_positiveData-1.png" class="img-fluid figure-img" width="864">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-trans_positiveData-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.4: Effect of common transformations on positive data.
</figcaption></figure>
</div>
</div>
</div>
<p>And for proportions:</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">proportion_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>orig<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0.01</span>, <span class="fl">0.99</span>, length.out<span class="op">=</span><span class="fl">1e3</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>sqrt<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">orig</span><span class="op">)</span>,</span>
<span>         ln<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">orig</span><span class="op">)</span>,</span>
<span>         asin<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">asin</a></span><span class="op">(</span><span class="va">orig</span><span class="op">)</span>,</span>
<span>         logit<span class="op">=</span><span class="fu">boot</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/boot/man/logit.html">logit</a></span><span class="op">(</span><span class="va">orig</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span>cols<span class="op">=</span><span class="fl">2</span><span class="op">:</span><span class="fl">5</span>, names_to<span class="op">=</span><span class="st">"transformation"</span>, values_to<span class="op">=</span><span class="st">"new_value"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">proportion_df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">orig</span>, <span class="va">new_value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">transformation</span>, scales<span class="op">=</span><span class="st">"free"</span>, nrow<span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>main<span class="op">=</span><span class="st">"Proportions"</span>, x<span class="op">=</span><span class="st">"Original value"</span>, y<span class="op">=</span><span class="st">"Transformed value"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div id="fig-trans_proportionalData" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-trans_proportionalData-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="P3_normal_files/figure-html/fig-trans_proportionalData-1.png" class="img-fluid figure-img" width="864">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-trans_proportionalData-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.5: Effect of common transformations on proportions.
</figcaption></figure>
</div>
</div>
</div>
<div id="Q.-3.22" class="Q.">
<p></p><details class="Q. fbx-simplebox fbx-default" open=""><summary><strong>Q. 3.22</strong></summary><div>Using the Radon concentration worksheet, plot the data. Do they look normally distributed?
</div></details><p></p>
</div>
<div class="cell">
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># get the Radon data into R; the units are parts per billion</span></span>
<span><span class="fu">readxl</span><span class="fu">::</span><span class="fu"><a href="https://readxl.tidyverse.org/reference/excel_sheets.html">excel_sheets</a></span><span class="op">(</span><span class="st">"data/H2DS_practicalData.xlsx"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="Q.-3.23" class="Q.">
<p></p><details class="Q. fbx-simplebox fbx-default" open=""><summary><strong>Q. 3.23</strong></summary><div>In your own time, use R to determine the log, square root, and reciprocals (and combinations of all of them: at least one converts the data to approximate normality).
</div></details><p></p>
</div>
<hr></section><section id="the-central-limit-theorem" class="level2" data-number="3.6"><h2 data-number="3.6" class="anchored" data-anchor-id="the-central-limit-theorem">
<span class="header-section-number">3.6</span> The Central Limit Theorem</h2>
<p>The central limit theorem (CLT) is about how <em>sample means</em> are distributed.</p>
<p>The CLT states that <strong>the means of normally distributed data will, themselves, be normally distributed</strong>.</p>
<p>In addition, the theorem states that <strong>the means of data which are NOT normally distributed will be normally distributed if the sample size is sufficiently large</strong>. In this practical we are going to demonstrate this theorem using random data generated from various probability distributions.</p>
<section id="the-distribution-of-means-from-non-normal-data" class="level3" data-number="3.6.1"><h3 data-number="3.6.1" class="anchored" data-anchor-id="the-distribution-of-means-from-non-normal-data">
<span class="header-section-number">3.6.1</span> The distribution of means from non-normal data</h3>
<p>The following code chunk:</p>
<ol type="1">
<li>Generates a non-normally distributed dataset (<code>obs_data</code>)</li>
<li>Repeatedly samples from it <code>num_samples</code> times, each with <code>sample_size</code> observations</li>
<li>Calculates and stores the sample mean for each <code>num_samples</code> repeat</li>
<li>Plots histograms and QQ-plots for the raw data and for the sample means</li>
</ol>
<p>Run the following code and then experiment with the <code>sample_size</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Non-normal data: a mixture of several distributions</span></span>
<span><span class="va">obs_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">2000</span>, <span class="fl">200</span>, <span class="fl">20</span><span class="op">)</span>, </span>
<span>              <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">1500</span>, <span class="fl">100</span>, <span class="fl">50</span><span class="op">)</span>,</span>
<span>              <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">1000</span>, <span class="fl">400</span>, <span class="fl">80</span><span class="op">)</span>, </span>
<span>              <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">800</span>, <span class="fl">300</span>, <span class="fl">100</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">xlims</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html">range</a></span><span class="op">(</span><span class="va">obs_data</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Define size of each sample and the number of sampling repeats</span></span>
<span><span class="va">sample_size</span> <span class="op">&lt;-</span> <span class="fl">30</span></span>
<span><span class="va">num_samples</span> <span class="op">&lt;-</span> <span class="fl">3000</span></span>
<span></span>
<span><span class="co"># Sample num_samples times from obs_data, with n = sample_size for each sample</span></span>
<span><span class="va">sample_means</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">numeric</a></span><span class="op">(</span>length<span class="op">=</span><span class="va">num_samples</span><span class="op">)</span> <span class="co"># initialize an empty vector</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">num_samples</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">sample_means</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">obs_data</span>, size<span class="op">=</span><span class="va">sample_size</span>, replace<span class="op">=</span><span class="cn">T</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># plot observed distribution</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>    mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span> </span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">obs_data</span>,</span>
<span>     main <span class="op">=</span> <span class="st">"Raw data: obs_data"</span>,</span>
<span>     sub <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"mean: "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">signif</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">obs_data</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span>, </span>
<span>                  <span class="st">", sd: "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">signif</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">obs_data</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span>,</span>
<span>     breaks <span class="op">=</span> <span class="fl">30</span>, xlab <span class="op">=</span> <span class="st">"Observations"</span>, xlim <span class="op">=</span> <span class="va">xlims</span></span>
<span><span class="op">)</span> </span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/qqnorm.html">qqnorm</a></span><span class="op">(</span><span class="va">obs_data</span>, main <span class="op">=</span> <span class="st">"Raw data QQ"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/qqnorm.html">qqline</a></span><span class="op">(</span><span class="va">obs_data</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># plot distribution of sample means</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">sample_means</span>,</span>
<span>     main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"Sample means, N: "</span>, <span class="va">sample_size</span><span class="op">)</span>,</span>
<span>     sub <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"mean: "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">signif</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">sample_means</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span>, </span>
<span>                  <span class="st">", sd: "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">signif</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">sample_means</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span>,</span>
<span>     breaks <span class="op">=</span> <span class="fl">30</span>, xlab <span class="op">=</span> <span class="st">"Sample means"</span>, xlim <span class="op">=</span> <span class="va">xlims</span></span>
<span><span class="op">)</span> </span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/qqnorm.html">qqnorm</a></span><span class="op">(</span><span class="va">sample_means</span>, main<span class="op">=</span><span class="st">"Sample mean QQ"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/qqnorm.html">qqline</a></span><span class="op">(</span><span class="va">sample_means</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-clt_examp" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-clt_examp-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="P3_normal_files/figure-html/fig-clt_examp-1.png" class="img-fluid figure-img" width="576">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-clt_examp-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.6: The central limit theorem in action.
</figcaption></figure>
</div>
</div>
</div>
<div id="Q.-3.24" class="Q.">
<p></p><details class="Q. fbx-simplebox fbx-default" open=""><summary><strong>Q. 3.24</strong></summary><div>What do you notice about the location of the mean as a function of <code>sample_size</code> (<span class="math inline">\(n\)</span>)?
</div></details><p></p>
</div>
<div id="Q.-3.25" class="Q.">
<p></p><details class="Q. fbx-simplebox fbx-default" open=""><summary><strong>Q. 3.25</strong></summary><div>What do you notice about the spread around the mean of sample means as a function of <code>sample_size</code>? Why did the pattern you have observed occur?
</div></details><p></p>
</div>
<p>The CLT states that <code>sample_means</code> will be normally distributed if (a) the underlying data are normally distributed, OR (b) the <code>sample_size</code> is large enough. With R, we can see this in action.</p>
<p>Note also the relationship between the sample size and the range of values for the sample mean. How does the standard deviation of <code>sample_means</code> change with changes in <code>sample_size</code>?.</p>
<hr></section></section><section id="the-standard-error-of-the-mean" class="level2" data-number="3.7"><h2 data-number="3.7" class="anchored" data-anchor-id="the-standard-error-of-the-mean">
<span class="header-section-number">3.7</span> The standard error of the mean</h2>
<p>The standard error of the mean is the standard deviation of sample means, of a given sample size, taken from a population. It describes the dispersion of sample means (<span class="math inline">\(\bar{y}\)</span>’s) we would expect if we were to repeatedly sample the same population over and over again. It is the standard deviation of the distribution shown in the lower histogram in <a href="#fig-clt_examp" class="quarto-xref">Figure&nbsp;<span>3.6</span></a> : <code>sd(sample_means)</code>.</p>
<p>Usually we only have a single sample rather than 10,000 (=<code>num_samples</code>) as above. In that case, we estimate it from a single sample as <span class="math inline">\({SE}_{\bar{y}} = \frac{sd(y)}{\sqrt{n}}\)</span>, where <span class="math inline">\(y\)</span> is a vector of <span class="math inline">\(n\)</span> observations.</p>
<p>We can explore this similarly to the simulated sampling we did for the CLT.</p>
<div class="cell">
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Simulate a normally distributed population with mean mu and sd sigma</span></span>
<span><span class="va">mu</span> <span class="op">&lt;-</span> <span class="fl">10</span></span>
<span><span class="va">sigma</span> <span class="op">&lt;-</span> <span class="fl">2</span></span>
<span><span class="va">sim_obs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">10000</span>, <span class="va">mu</span>, <span class="va">sigma</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Define sample size and number</span></span>
<span><span class="va">sample_size</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">10</span>, <span class="fl">30</span>, <span class="fl">100</span><span class="op">)</span> <span class="co"># size of each sample</span></span>
<span><span class="va">num_samples</span> <span class="op">&lt;-</span> <span class="fl">3000</span> <span class="co"># number of samples (=repeats) for each sample size</span></span>
<span></span>
<span><span class="co"># Create a dataframe to store results</span></span>
<span><span class="va">sample_mean_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>N<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="va">sample_size</span>, each <span class="op">=</span> <span class="va">num_samples</span><span class="op">)</span>,</span>
<span>                         id<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">num_samples</span>, times <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">sample_size</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rowwise.html">rowwise</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="co"># enforces new sample() call for each row</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>sample_mean<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">sim_obs</span>, size<span class="op">=</span><span class="va">N</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">ungroup</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">sample_mean_df</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>N<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">N</span>, levels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">N</span><span class="op">)</span>, labels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"n:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">N</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">sample_mean</span>, colour<span class="op">=</span><span class="va">N</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span><span class="op">(</span>xintercept<span class="op">=</span><span class="va">mu</span>, linetype<span class="op">=</span><span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html">geom_density</a></span><span class="op">(</span>linewidth<span class="op">=</span><span class="fl">0.9</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html">scale_colour_viridis_d</a></span><span class="op">(</span><span class="st">"Size of each sample"</span>, option<span class="op">=</span><span class="st">"mako"</span>, end<span class="op">=</span><span class="fl">0.85</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Means of"</span>, <span class="va">num_samples</span>, <span class="st">"simulated samples"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_classic</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-SEM" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-SEM-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="P3_normal_files/figure-html/fig-SEM-1.png" class="img-fluid figure-img" width="576">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-SEM-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.7: Simulated sample means. Each curve shows the sampling distribution for means of samples with size n.&nbsp;The standard deviation of each curve is the standard error of the mean.
</figcaption></figure>
</div>
</div>
</div>
<div id="Q.-3.26" class="Q.">
<p></p><details class="Q. fbx-simplebox fbx-default" open=""><summary><strong>Q. 3.26</strong></summary><div>Calculate the theoretical standard error of the mean for each <code>sample_size</code> given <code>sigma</code> (i.e., from the equation) and compare this with the standard error from the simulated sample means in <code>sample_mean_df</code>.
</div></details><p></p>
</div>
<p>Hint:</p>
<div class="cell">
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">sample_mean_df</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">N</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># what goes here?</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-simple callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
View solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">sample_mean_df</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">N</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>se_bySim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">sample_mean</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">ungroup</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>se_byFormula<span class="op">=</span><span class="va">sigma</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">N</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 3
      N se_bySim se_byFormula
  &lt;dbl&gt;    &lt;dbl&gt;        &lt;dbl&gt;
1     3    1.16         1.15 
2    10    0.631        0.632
3    30    0.371        0.365
4   100    0.194        0.2  </code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="Q.-3.27" class="Q.">
<p></p><details class="Q. fbx-simplebox fbx-default" open=""><summary><strong>Q. 3.27</strong></summary><div>Given what you know about the CLT, how does this change with non-normally distributed data? Try creating <code>sim_obs</code> using <code><a href="https://rdrr.io/r/stats/Poisson.html">rpois()</a></code>.
</div></details><p></p>
</div>
<div id="Q.-3.28" class="Q.">
<p></p><details class="Q. fbx-simplebox fbx-default" open=""><summary><strong>Q. 3.28</strong></summary><div>Change <code>sigma</code> and <code>sample_size</code> and check that the standard error estimates are in line with their true values (i.e., as determined by using the standard error formula).
</div></details><p></p>
</div>
<hr></section><section id="normal-approximations" class="level2" data-number="3.8"><h2 data-number="3.8" class="anchored" data-anchor-id="normal-approximations">
<span class="header-section-number">3.8</span> Normal approximations</h2>
<p>In <a href="P2_binomial_poisson.html" class="quarto-xref"><span>Chapter 2</span></a> you saw that the Poisson distribution could be used to approximate the binomial distribution. In a conceptually similar way, the normal distribution can be used to approximate both the Poisson distribution and the binomial distribution under certain conditions.</p>
<p>While the Poisson and binomial distributions are discrete and the normal distribution continuous, in practice all of our observations are discontinuous, subject to our measurement precision. A recorded mass of 437 g really indicates a mass between 436.5 and 437.5 g. The assumption that a variable is continuous is typically reasonable if there at least ~30 possible values between the smallest and largest observation. This constraint similarly applies to the approximation of binomial and Poisson distributions with the normal distribution.</p>
<div class="callout callout-style-simple callout-note">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>All models are wrong, but some are useful! Normality is always approximate in practice.</p>
</div>
</div>
</div>
<section id="the-normal-approximation-of-the-poisson-distribution" class="level3" data-number="3.8.1"><h3 data-number="3.8.1" class="anchored" data-anchor-id="the-normal-approximation-of-the-poisson-distribution">
<span class="header-section-number">3.8.1</span> The Normal approximation of the Poisson distribution</h3>
<p>Recall that the Poisson model takes only one parameter, <span class="math inline">\(\lambda\)</span> = mean = variance. So if we have a variable <span class="math inline">\(y \sim Pois(10)\)</span>, the mean (e.g., density per quadrat) is 10 and so is the variance. We now have the two parameters that define the normal distribution.</p>
<div id="Q.-3.29" class="Q.">
<p></p><details class="Q. fbx-simplebox fbx-default" open=""><summary><strong>Q. 3.29</strong></summary><div>For <span class="math inline">\(y \sim Pois(10)\)</span> write the equivalent normal distribution: <span class="math inline">\(y \sim Norm(...)\)</span>.
</div></details><p></p>
</div>
<p>A normal approximation may be reasonable if <span class="math inline">\(\lambda \geq 30\)</span>. So <span class="math inline">\(y \sim Pois(10)\)</span> should not be approximated by the normal distribution while <span class="math inline">\(y \sim Pois(30)\)</span> could be. As <span class="math inline">\(\lambda\)</span> gets larger, the Poisson distribution becomes more and more computationally demanding compared to the normal distribution. Many standard statistical analyses also assume normal distributions.</p>
<p>However, when feasible, it is generally preferable to use the natural distribution for your data (e.g., a Poisson distribution for counts) through the appropriate GLM. The normal distribution is beneficial in some cases, but this is increasingly less so with modern methods.</p>
<div id="Q.-3.30" class="Q.">
<p></p><details class="Q. fbx-simplebox fbx-default" open=""><summary><strong>Q. 3.30</strong></summary><div>Calculate <span class="math inline">\(P(y_i \leq 35)\)</span> from <span class="math inline">\(y \sim Pois(40)\)</span> and compare it to the same probability under the normal approximation of this distribution.
</div></details><p></p>
</div>
<div id="Q.-3.31" class="Q.">
<p></p><details class="Q. fbx-simplebox fbx-default" open=""><summary><strong>Q. 3.31</strong></summary><div>Evaluate <span class="math inline">\(P(y_i&lt;3\ |\ \lambda=5)\)</span> using the Poisson model and its normal approximation.
</div></details><p></p>
</div>
</section><section id="the-normal-approximation-of-the-binomial-distribution" class="level3" data-number="3.8.2"><h3 data-number="3.8.2" class="anchored" data-anchor-id="the-normal-approximation-of-the-binomial-distribution">
<span class="header-section-number">3.8.2</span> The Normal approximation of the binomial distribution</h3>
<p>When <span class="math inline">\(n\)</span> is large, the binomial distribution tends toward a normal distribution, particularly if <span class="math inline">\(p\)</span> is near 0.5. Roughly speaking, if <span class="math inline">\(np &gt; 5\)</span> and <span class="math inline">\(n(1-p) &gt; 5\)</span>, then the normal distribution may be a reasonable approximation. The mean of the binomial distribution is <span class="math inline">\(np\)</span> and the variance is <span class="math inline">\(npq\)</span>.</p>
<p>We might be interested in predicting the number of male and female offspring in turtle clutches. Assume the proportion that are male is 0.5 and clutch size is 40. We’ve observed several clutches of eggs on a particular island with only 10 males. We might wonder how unlikely this was by chance, assuming <span class="math inline">\(P(male)=0.5\)</span>.</p>
<div id="Q.-3.32" class="Q.">
<p></p><details class="Q. fbx-simplebox fbx-default" open=""><summary><strong>Q. 3.32</strong></summary><div>What is the probability of observing 10 or fewer males in this scenario?
</div></details><p></p>
</div>
<div id="Q.-3.33" class="Q.">
<p></p><details class="Q. fbx-simplebox fbx-default" open=""><summary><strong>Q. 3.33</strong></summary><div>Plot the probability (i.e.&nbsp;from 0 – 40 males) as a bar graph and comment on its shape.
</div></details><p></p>
</div>
<div id="Q.-3.34" class="Q.">
<p></p><details class="Q. fbx-simplebox fbx-default" open=""><summary><strong>Q. 3.34</strong></summary><div>Calculate the mean and variance of this population.
</div></details><p></p>
</div>
<div id="Q.-3.35" class="Q.">
<p></p><details class="Q. fbx-simplebox fbx-default" open=""><summary><strong>Q. 3.35</strong></summary><div>Are <span class="math inline">\(np\)</span> and <span class="math inline">\(n(1-p)\)</span> both &gt; 5?
</div></details><p></p>
</div>
<div id="Q.-3.36" class="Q.">
<p></p><details class="Q. fbx-simplebox fbx-default" open=""><summary><strong>Q. 3.36</strong></summary><div>Specify the normal distribution that approximates this binomial distribution.
</div></details><p></p>
</div>
<div id="Q.-3.37" class="Q.">
<p></p><details class="Q. fbx-simplebox fbx-default" open=""><summary><strong>Q. 3.37</strong></summary><div>What is <span class="math inline">\(P(y_i \leq 10)\)</span> for the normal approximation?
</div></details><p></p>
</div>
<hr></section></section><section id="conclusions" class="level2" data-number="3.9"><h2 data-number="3.9" class="anchored" data-anchor-id="conclusions">
<span class="header-section-number">3.9</span> Conclusions</h2>
<p>The normal distribution is central to statistics. A huge variety of observations are reasonably approximated by the normal distribution (or can be made to be normally distributed through transformation).</p>
<p>The normal distribution can be used to assess the likelihood of a given observation, if we know the population mean and standard deviation from which it came. Furthermore, given our knowledge of the population parameters (<span class="math inline">\(\mu\)</span>, <span class="math inline">\(\sigma\)</span>) we can determine values which define intervals on that population. Frequently scientists determine the values that bound 95% of their data.</p>
<p>The central limit theorem says that sample means taken from a normally distributed population will themselves be normally distributed and, in addition, means of sufficiently large samples will also be normally distributed even where the original data are not normally distributed (the sample size required depends on the extent of the skew in the original data).</p>
<p>The normal distribution is a good approximation of the Poisson distribution when lambda is large and the binomial model where the number of trials is large and the probability of success around 0.5 (i.e.&nbsp;the distribution of values is not too skewed).</p>


</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("^(?:http:|https:)\/\/\.sz-tim\.quarto\.pub/custom");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
          // target, if specified
          link.setAttribute("target", "_blank");
          if (link.getAttribute("rel") === null) {
            link.setAttribute("rel", "noopener");
          }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./P2_binomial_poisson.html" class="pagination-link" aria-label="Binomial and Poisson distributions">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Binomial and Poisson distributions</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./P4_t_CIs.html" class="pagination-link" aria-label="The t-distribution and confidence intervals">
        <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">The t-distribution and confidence intervals</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/Sz-Tim/H2DS_Practicals/issues/new" class="toc-action"><i class="bi bi-github"></i>Report an issue</a></li></ul></div></div></div></footer></body></html>