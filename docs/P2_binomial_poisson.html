<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.40">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>2&nbsp; Binomial and Poisson distributions – H2 Data Science Practicals</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./P3_normal.html" rel="next">
<link href="./P1_R_recap.html" rel="prev">
<link href="./figs/one_distribution.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-549806ee2085284f45b00abea8c6df48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-d5d78c9e45e9a5253a6059031ce5ea1b.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/quarto-contrib/foldbox/foldbox.css" rel="stylesheet"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><style>
.Q. {
  --color1: #69B7CE;
  --color2: #3F6F76;
}
</style>
<script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>
</head>
<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./P2_binomial_poisson.html"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Binomial and Poisson distributions</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">H2 Data Science Practicals</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/Sz-Tim/H2DS_Practicals" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
    <div class="dropdown">
      <a href="" title="Download" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" role="link" aria-label="Download"><i class="bi bi-download"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
<li>
            <a class="dropdown-item sidebar-tools-main-item" href="./H2-Data-Science-Practicals.pdf">
              <i class="bi bi-file-pdf pe-1"></i>
            Download PDF
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="./H2-Data-Science-Practicals.epub">
              <i class="bi bi-journal pe-1"></i>
            Download ePub
            </a>
          </li>
      </ul>
</div>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./P0_R_setup.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">R setup</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./P1_R_recap.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">R recap</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./P2_binomial_poisson.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Binomial and Poisson distributions</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./P3_normal.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Normal distribution</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./P4_t_CIs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">The t-distribution and confidence intervals</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./P5_ANOVA_regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">ANOVA and regression</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./P6_machine_learning.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Machine Learning</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./P7_appendix.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Appendix</span></span></a>
  </div>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li>
<a href="#the-binomial-distribution" id="toc-the-binomial-distribution" class="nav-link active" data-scroll-target="#the-binomial-distribution"><span class="header-section-number">2.1</span> The Binomial distribution</a>
  <ul class="collapse">
<li><a href="#bernoulli-trials" id="toc-bernoulli-trials" class="nav-link" data-scroll-target="#bernoulli-trials"><span class="header-section-number">2.1.1</span> Bernoulli trials</a></li>
  <li><a href="#the-binomial-distribution-1" id="toc-the-binomial-distribution-1" class="nav-link" data-scroll-target="#the-binomial-distribution-1"><span class="header-section-number">2.1.2</span> The binomial distribution</a></li>
  <li><a href="#binomial-distributions-by-hand" id="toc-binomial-distributions-by-hand" class="nav-link" data-scroll-target="#binomial-distributions-by-hand"><span class="header-section-number">2.1.3</span> Binomial distributions by hand</a></li>
  <li><a href="#binomial-distributions-in-r" id="toc-binomial-distributions-in-r" class="nav-link" data-scroll-target="#binomial-distributions-in-r"><span class="header-section-number">2.1.4</span> Binomial distributions in R</a></li>
  </ul>
</li>
  <li>
<a href="#the-poisson-distribution" id="toc-the-poisson-distribution" class="nav-link" data-scroll-target="#the-poisson-distribution"><span class="header-section-number">2.2</span> The Poisson distribution</a>
  <ul class="collapse">
<li><a href="#poisson-distributions-by-hand" id="toc-poisson-distributions-by-hand" class="nav-link" data-scroll-target="#poisson-distributions-by-hand"><span class="header-section-number">2.2.1</span> Poisson distributions by hand</a></li>
  <li><a href="#poisson-distributions-using-pois-functions" id="toc-poisson-distributions-using-pois-functions" class="nav-link" data-scroll-target="#poisson-distributions-using-pois-functions"><span class="header-section-number">2.2.2</span> Poisson distributions using *pois() functions</a></li>
  </ul>
</li>
  <li><a href="#the-poisson-approximation-of-the-binomial-model" id="toc-the-poisson-approximation-of-the-binomial-model" class="nav-link" data-scroll-target="#the-poisson-approximation-of-the-binomial-model"><span class="header-section-number">2.3</span> The Poisson approximation of the binomial model</a></li>
  <li><a href="#conclusions" id="toc-conclusions" class="nav-link" data-scroll-target="#conclusions"><span class="header-section-number">2.4</span> Conclusions</a></li>
  </ul><div class="toc-actions"><ul><li><a href="https://github.com/Sz-Tim/H2DS_Practicals/issues/new" class="toc-action"><i class="bi bi-github"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title"><span id="sec-P2" class="quarto-section-identifier"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Binomial and Poisson distributions</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><p>We often wish to determine the probability of events occurring given our current understanding of the processes that are involved. This requires a mathematical description of a theoretical relationship. We refer to this as a statistical model. Models are simplified representations of reality. As George Box said, ‘All models are wrong but some are useful’.</p>
<p>Two models, the binomial and Poisson distributions, often provide excellent approximations of real-world events. This means that they can be used to determine the likelihood of events or series of events given certain ‘reasonable’ assumptions. In terms of planning, e.g.&nbsp;in the insurance industry, this is extremely useful.</p>
<p>For example, the binomial or Poisson distributions can be used to answer:</p>
<ul>
<li>How likely is it that four hurricanes hit the US in one season based on historic data?</li>
<li>How likely is it that a ‘50-year’ wave will hit in the next ten years?</li>
<li>Is a river flooding more frequently now than it used to?</li>
<li>What proportion of egg clutches in a fish population will be all males?</li>
</ul>
<p>This practical gives you the opportunity to practice using these distributions.</p>
<div class="cell">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
<section id="the-binomial-distribution" class="level2" data-number="2.1"><h2 data-number="2.1" class="anchored" data-anchor-id="the-binomial-distribution">
<span class="header-section-number">2.1</span> The Binomial distribution</h2>
<section id="bernoulli-trials" class="level3" data-number="2.1.1"><h3 data-number="2.1.1" class="anchored" data-anchor-id="bernoulli-trials">
<span class="header-section-number">2.1.1</span> Bernoulli trials</h3>
<p>A Bernoulli trial is a single event with a <em>binary</em> outcome (i.e., two categories that are mutually exclusive). Binary outcomes include:</p>
<ul>
<li>Alive vs.&nbsp;dead</li>
<li>Reproductive vs.&nbsp;not reproductive</li>
<li>Present vs.&nbsp;absent</li>
</ul>
<p>Other variables can be re-coded into a binary outcome. For example:</p>
<ul>
<li>Flower colour (blue vs.&nbsp;not blue)</li>
<li>Income (<span class="math inline">\(\geq\)</span> £100,000 vs.&nbsp;<span class="math inline">\(&lt;\)</span> £100,000)</li>
</ul>
<p>By definition, each Bernoulli trial is independent of all previous trials.</p>
<div id="Q.-2.1" class="Q.">
<p></p><details class="Q. fbx-simplebox fbx-default" open=""><summary><strong>Q. 2.1</strong></summary><div>A fair coin has been heads in 99 consecutive flips. What is the probability of heads on the next flip?
</div></details><p></p>
</div>
<p>This is different to asking whether (100 heads) or (99 heads + 1 tails) is more likely in a throw of 100 coins. This is different because each flip is independent.</p>
</section><section id="the-binomial-distribution-1" class="level3" data-number="2.1.2"><h3 data-number="2.1.2" class="anchored" data-anchor-id="the-binomial-distribution-1">
<span class="header-section-number">2.1.2</span> The binomial distribution</h3>
<p>The binomial distribution is a discrete probability distribution that applies to a series of Bernoulli trials.</p>
<p>For example, if a chicken laid 4 eggs and they were all female, you might wonder how likely this was by chance. Here, the outcome can be female or male, and the number of trials is 4: each egg is a ‘trial’ or ‘event’ with a binary outcome. You may question the assumption that the ratio of female:male was 50:50 and favour an alternative hypothesis that females are more likely. The binomial distribution allows you to quantify the probability of getting <span class="math inline">\(x\)</span> females from <span class="math inline">\(n\)</span> eggs for any given probability <span class="math inline">\(p=P(female)\)</span>. That is, we are not restricted to 50:50.</p>
<p>You need to know two things to use the binomial distribution. These are:</p>
<ul>
<li>The number of trials (<span class="math inline">\(n\)</span>, or sometimes <span class="math inline">\(k\)</span>)</li>
<li>The probability of success (<span class="math inline">\(p\)</span>)</li>
</ul>
<p>From <em>p</em>, we can calculate the probability of failure as <span class="math inline">\(q = (1-p)\)</span>, since the two probabilities must sum to 1.</p>
<p>The distribution of a binomially distributed variable <span class="math inline">\(y\)</span> is specified as <span class="math inline">\(y \sim Binom(n,p)\)</span>. We denote <span class="math inline">\(P(x)\)</span> as the probability of getting <span class="math inline">\(x\)</span> successes where <span class="math inline">\(x\)</span> is an integer from <span class="math inline">\(0\)</span> to <span class="math inline">\(n\)</span>.</p>
<p>The <strong>mean of a binomial distribution</strong> is <span class="math inline">\(n*p\)</span>. This gives you the <em>expected</em> outcome. For example, if <span class="math inline">\(P(female)=0.5\)</span> and <span class="math inline">\(n=4\)</span> eggs the expected number of females is <span class="math inline">\(4*0.5=2\)</span>.</p>
</section><section id="binomial-distributions-by-hand" class="level3" data-number="2.1.3"><h3 data-number="2.1.3" class="anchored" data-anchor-id="binomial-distributions-by-hand">
<span class="header-section-number">2.1.3</span> Binomial distributions by hand</h3>
<p>Wongles always lay two eggs in a clutch but 50% of the eggs are infertile and don’t hatch. We are interested in the proportion that we expect to hatch from one clutch (two eggs).</p>
<div id="Q.-2.2" class="Q.">
<p></p><details class="Q. fbx-simplebox fbx-default" open=""><summary><strong>Q. 2.2</strong></summary><div>What is the event?
</div></details><p></p>
</div>
<div id="Q.-2.3" class="Q.">
<p></p><details class="Q. fbx-simplebox fbx-default" open=""><summary><strong>Q. 2.3</strong></summary><div>What is <span class="math inline">\(p\)</span>?
</div></details><p></p>
</div>
<div id="Q.-2.4" class="Q.">
<p></p><details class="Q. fbx-simplebox fbx-default" open=""><summary><strong>Q. 2.4</strong></summary><div>What is the number of trials?
</div></details><p></p>
</div>
<div id="Q.-2.5" class="Q.">
<p></p><details class="Q. fbx-simplebox fbx-default" open=""><summary><strong>Q. 2.5</strong></summary><div>How many possible outcomes are there for a clutch? What are they?
</div></details><p></p>
</div>
<div id="Q.-2.6" class="Q.">
<p></p><details class="Q. fbx-simplebox fbx-default" open=""><summary><strong>Q. 2.6</strong></summary><div>Write down the model specification with parameters (i.e., <span class="math inline">\(y \sim Binom(...)\)</span>).
</div></details><p></p>
</div>
<div id="Q.-2.7" class="Q.">
<p></p><details class="Q. fbx-simplebox fbx-default" open=""><summary><strong>Q. 2.7</strong></summary><div>Calculate the expected proportions of clutches that contain (a) two fertile, (b) two infertile, and (c) one of each. Use a probability tree if needed.
</div></details><p></p>
</div>
<div id="Q.-2.8" class="Q.">
<p></p><details class="Q. fbx-simplebox fbx-default" open=""><summary><strong>Q. 2.8</strong></summary><div>Using the binomial probability mass function from <a href="P7_appendix.html" class="quarto-xref"><span>Chapter 7</span></a>, calculate the expected proportions for two eggs.
</div></details><p></p>
</div>
<p>Unlike Wongles, Oozles always have broods of eight offspring and all of them hatch. We are interested in modelling the probabilities of the number of male and female offspring in these broods of eight eggs.</p>
<div id="Q.-2.9" class="Q.">
<p></p><details class="Q. fbx-simplebox fbx-default" open=""><summary><strong>Q. 2.9</strong></summary><div>What is the Bernoulli event?
</div></details><p></p>
</div>
<div id="Q.-2.10" class="Q.">
<p></p><details class="Q. fbx-simplebox fbx-default" open=""><summary><strong>Q. 2.10</strong></summary><div>What are the theoretical limits to your outcomes (i.e, max numbers of each)?
</div></details><p></p>
</div>
<div id="Q.-2.11" class="Q.">
<p></p><details class="Q. fbx-simplebox fbx-default" open=""><summary><strong>Q. 2.11</strong></summary><div>What are the possible outcomes? What is the number of possible outcomes?
</div></details><p></p>
</div>
<p>We will assume that the probability <span class="math inline">\(p\)</span> of any offspring being female is 0.5 and being male <span class="math inline">\(q\)</span> is 0.5. For the extreme cases where all offspring are one sex, we can use simple probability theory: the probability of getting <span class="math inline">\(n\)</span> females in a brood of size <span class="math inline">\(n\)</span> is equal to <span class="math inline">\(p^n\)</span>.</p>
<div id="Q.-2.12" class="Q.">
<p></p><details class="Q. fbx-simplebox fbx-default" open=""><summary><strong>Q. 2.12</strong></summary><div>Write down the model for Oozle egg sex: <span class="math inline">\(y \sim Binom(n,p)\)</span>.
</div></details><p></p>
</div>
<div id="Q.-2.13" class="Q.">
<p></p><details class="Q. fbx-simplebox fbx-default" open=""><summary><strong>Q. 2.13</strong></summary><div>Calculate the probability of obtaining eight male offspring.
</div></details><p></p>
</div>
<div id="Q.-2.14" class="Q.">
<p></p><details class="Q. fbx-simplebox fbx-default" open=""><summary><strong>Q. 2.14</strong></summary><div>What is the mean number of females you would expect in Oozle broods?
</div></details><p></p>
</div>
<p>It gets more complicated when you want to know the probability of getting, say, 1 male and 7 females from your clutch of eight eggs.</p>
<div id="Q.-2.15" class="Q.">
<p></p><details class="Q. fbx-simplebox fbx-default" open=""><summary><strong>Q. 2.15</strong></summary><div>Given that <span class="math inline">\(p=q\)</span>, what shape would expect the distribution to be?
</div></details><p></p>
</div>
<div id="Q.-2.16" class="Q.">
<p></p><details class="Q. fbx-simplebox fbx-default" open=""><summary><strong>Q. 2.16</strong></summary><div>Use the binomial expression to calculate the probability of obtaining 0, 1, 2, 3, 4, 5, 6, 7 and 8 male offspring (note that the distribution is symmetric).
</div></details><p></p>
</div>
<p>It is much easier, of course, to do this using R.</p>
</section><section id="binomial-distributions-in-r" class="level3" data-number="2.1.4"><h3 data-number="2.1.4" class="anchored" data-anchor-id="binomial-distributions-in-r">
<span class="header-section-number">2.1.4</span> Binomial distributions in R</h3>
<p>R can calculate probabilities for specific outcomes from a massive array of theoretical probability distributions. The binomial is just one of them.</p>
<div class="callout callout-style-simple callout-warning">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>CHANGE THIS FOR NEXT YEAR! Very confusing and instead should just demonstrate the best method. Obviously.</p>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">num_female</span> <span class="op">&lt;-</span> <span class="fl">4</span> <span class="co"># note that 4 is assigned to the variable called num_female</span></span>
<span><span class="va">num_trials</span> <span class="op">&lt;-</span> <span class="fl">8</span></span>
<span><span class="va">p_female</span> <span class="op">&lt;-</span> <span class="fl">0.5</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># for a single probability: y~Binom(n=8, p=0.5) determine P(y_i=4)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">dbinom</a></span><span class="op">(</span><span class="va">num_female</span>, <span class="va">num_trials</span>, <span class="va">p_female</span><span class="op">)</span> <span class="co"># dbinom(4, 8, 0.5)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># formatted output just because:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"P("</span>, <span class="va">num_female</span>, <span class="st">" female | "</span>, <span class="va">num_trials</span>, <span class="st">" eggs) = "</span>,</span>
<span>       <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">dbinom</a></span><span class="op">(</span><span class="va">num_female</span>, <span class="va">num_trials</span>, <span class="va">p_female</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "P(4 female | 8 eggs) = 0.2734375"</code></pre>
</div>
</div>
<p>The function <code><a href="https://rdrr.io/r/stats/Binomial.html">dbinom()</a></code> gives the probability of a single outcome.</p>
<p>Often we want to know cumulative probabilities instead. This allows us to answer questions like <em>“What is the probability of obtaining &lt; 4 females in a brood of 8 eggs?”</em> Here, &lt;4 equates to the cumulative probability P(0) + P(1) + P(2) + P(3).</p>
<p>For these calculations, we can use <code>pbinom(...)</code> instead of <code>sum(dbinom(...))</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># pbinom gives the cumulative probability</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"The cumulative probability is"</span>, </span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">pbinom</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="va">num_female</span> <span class="op">-</span> <span class="fl">1</span>, <span class="va">num_trials</span>, <span class="va">p_female</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "The cumulative probability is 0.36328125"</code></pre>
</div>
</div>
<div id="Q.-2.17" class="Q.">
<p></p><details class="Q. fbx-simplebox fbx-default" open=""><summary><strong>Q. 2.17</strong></summary><div>Why do we parameterise <code><a href="https://rdrr.io/r/stats/Binomial.html">pbinom()</a></code> with <code>num_female-1</code> rather than <code>num_female</code>?
</div></details><p></p>
</div>
<div id="Q.-2.18" class="Q.">
<p></p><details class="Q. fbx-simplebox fbx-default" open=""><summary><strong>Q. 2.18</strong></summary><div>Would this change if the question was <span class="math inline">\(P( \leq 4)\)</span>?
</div></details><p></p>
</div>
<div id="Q.-2.19" class="Q.">
<p></p><details class="Q. fbx-simplebox fbx-default" open=""><summary><strong>Q. 2.19</strong></summary><div>Take <code>max</code> out of the above line and run again. You should see 5 cumulative probabilities. Why is the first cumulative probability zero?
</div></details><p></p>
</div>
<p>Note that R has vectorized the calculation, returning the probability for each value in vector from <code>0:num_female - 1</code>.</p>
<div id="Q.-2.20" class="Q.">
<p></p><details class="Q. fbx-simplebox fbx-default" open=""><summary><strong>Q. 2.20</strong></summary><div>Calculate P(&lt; 4 females | 8 eggs) using <code><a href="https://rdrr.io/r/stats/Binomial.html">dbinom()</a></code> instead of <code><a href="https://rdrr.io/r/stats/Binomial.html">pbinom()</a></code>.
</div></details><p></p>
</div>
<p>The above code has a bug in it. You can check what R is doing by running parts of the code:</p>
<div class="cell">
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fl">0</span><span class="op">:</span><span class="va">num_female</span> <span class="op">-</span> <span class="fl">1</span> <span class="co"># Oops! Is this what you expected?</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -1  0  1  2  3</code></pre>
</div>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fl">0</span><span class="op">:</span><span class="op">(</span><span class="va">num_female</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span> <span class="co"># this is actually what we want.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0 1 2 3</code></pre>
</div>
</div>
<div id="Q.-2.21" class="Q.">
<p></p><details class="Q. fbx-simplebox fbx-default" open=""><summary><strong>Q. 2.21</strong></summary><div>Correct the code above. Why did this bug have no effect?
</div></details><p></p>
</div>
<div id="Q.-2.22" class="Q.">
<p></p><details class="Q. fbx-simplebox fbx-default" open=""><summary><strong>Q. 2.22</strong></summary><div>What is the probability of getting 3 females?
</div></details><p></p>
</div>
<div id="Q.-2.23" class="Q.">
<p></p><details class="Q. fbx-simplebox fbx-default" open=""><summary><strong>Q. 2.23</strong></summary><div>What is the probability of getting 8 females?
</div></details><p></p>
</div>
<div id="Q.-2.24" class="Q.">
<p></p><details class="Q. fbx-simplebox fbx-default" open=""><summary><strong>Q. 2.24</strong></summary><div>What cumulative probabilities would you need to consider to answer the question <em>“What is the probability of getting fewer than three females?”</em>
</div></details><p></p>
</div>
<div id="Q.-2.25" class="Q.">
<p></p><details class="Q. fbx-simplebox fbx-default" open=""><summary><strong>Q. 2.25</strong></summary><div>Review your model that describes this random process (number of females per eight eggs) that you wrote above: <span class="math inline">\(y \sim Binom(n, p)\)</span>.
</div></details><p></p>
</div>
<div id="Q.-2.26" class="Q.">
<p></p><details class="Q. fbx-simplebox fbx-default" open=""><summary><strong>Q. 2.26</strong></summary><div>What is the probability of getting &lt; 4 females?
</div></details><p></p>
</div>
<div id="Q.-2.27" class="Q.">
<p></p><details class="Q. fbx-simplebox fbx-default" open=""><summary><strong>Q. 2.27</strong></summary><div>What is the probability of getting <span class="math inline">\(\leq\)</span> 4 females?
</div></details><p></p>
</div>
<div id="Q.-2.28" class="Q.">
<p></p><details class="Q. fbx-simplebox fbx-default" open=""><summary><strong>Q. 2.28</strong></summary><div>What is the probability of getting &gt; than 8 females?
</div></details><p></p>
</div>
<div id="Q.-2.29" class="Q.">
<p></p><details class="Q. fbx-simplebox fbx-default" open=""><summary><strong>Q. 2.29</strong></summary><div>What is the probability of getting <span class="math inline">\(\geq\)</span> than 2 females?
</div></details><p></p>
</div>
<p>Let’s visualize these distributions in order to better understand them.</p>
<div class="cell">
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Run this, then explore values of p_female</span></span>
<span><span class="co"># Note: 'success' and 'failure' is arbitrary. Just make sure you're calculating</span></span>
<span><span class="co"># what you think. How would you calculate the probabilities for males instead?</span></span>
<span><span class="va">num_female</span> <span class="op">&lt;-</span> <span class="fl">0</span><span class="op">:</span><span class="fl">8</span> </span>
<span><span class="va">p_female</span> <span class="op">&lt;-</span> <span class="fl">0.5</span> <span class="co"># what are the limits of p_female?</span></span>
<span><span class="va">prFemale_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>num_female<span class="op">=</span><span class="va">num_female</span>, </span>
<span>                          prob<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">dbinom</a></span><span class="op">(</span><span class="va">num_female</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">num_female</span><span class="op">)</span>, <span class="va">p_female</span><span class="op">)</span><span class="op">)</span> </span>
<span><span class="va">prFemale_df</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  num_female       prob
1          0 0.00390625
2          1 0.03125000
3          2 0.10937500
4          3 0.21875000
5          4 0.27343750
6          5 0.21875000
7          6 0.10937500
8          7 0.03125000
9          8 0.00390625</code></pre>
</div>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html">barplot</a></span><span class="op">(</span><span class="va">prFemale_df</span><span class="op">$</span><span class="va">prob</span>, names<span class="op">=</span><span class="va">prFemale_df</span><span class="op">$</span><span class="va">num_female</span>, </span>
<span>        xlab<span class="op">=</span><span class="st">"Number of females"</span>, ylab<span class="op">=</span><span class="st">"Probability"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-binom_dist" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-binom_dist-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="P2_binomial_poisson_files/figure-html/fig-binom_dist-1.png" class="img-fluid figure-img" width="480">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-binom_dist-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2.1: Binomial probability distribution
</figcaption></figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">prFemale_df</span><span class="op">$</span><span class="va">cumul_prob</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html">cumsum</a></span><span class="op">(</span><span class="va">prFemale_df</span><span class="op">$</span><span class="va">prob</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html">barplot</a></span><span class="op">(</span><span class="va">prFemale_df</span><span class="op">$</span><span class="va">cumul_prob</span>, names<span class="op">=</span><span class="va">prFemale_df</span><span class="op">$</span><span class="va">num_female</span>, </span>
<span>        xlab<span class="op">=</span><span class="st">"Enter the correct label!"</span>, ylab<span class="op">=</span><span class="st">"Enter the correct label!"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-binom_cum_dist" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-binom_cum_dist-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="P2_binomial_poisson_files/figure-html/fig-binom_cum_dist-1.png" class="img-fluid figure-img" width="480">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-binom_cum_dist-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2.2: Cumulative binomial probability distribution
</figcaption></figure>
</div>
</div>
</div>
<p>Try re-plotting so that the two panels appear side by side (hint: <code>par(mfrow=c(...))</code>).</p>
<p>Note <span class="math inline">\(P(y_i=x)\)</span> is read as ‘the probability that a random observation y sub i equals x’. Sometimes this includes conditions: <span class="math inline">\(P(y_i=x|n,p)\)</span>, which is read as the probability that <span class="math inline">\(y_i\)</span> equals <span class="math inline">\(x\)</span> given <span class="math inline">\(n\)</span> and <span class="math inline">\(p\)</span>. You may see <span class="math inline">\(P()\)</span>, <span class="math inline">\(Pr()\)</span>, <span class="math inline">\(p()\)</span>, or <span class="math inline">\(Prob()\)</span>, which all mean the same thing.</p>
<p>The interpretation of <span class="math inline">\(P(y_i=8\ |\ n=8,\ p=0.5) = 0.00391\)</span> is that the probability of 8 female offspring in a clutch of 8 eggs where each egg has 50% probability of being female is 0.00391.</p>
<p>In other words, if we have 500 broods, each with 8 eggs, we expect <span class="math inline">\(500 * 0.00391 = 1.95 \approx 2\)</span> broods to be all female. Is there something strange about our Oozle or is it just one of the 2/500 by chance?</p>
<div id="Q.-2.30" class="Q.">
<p></p><details class="Q. fbx-simplebox fbx-default" open=""><summary><strong>Q. 2.30</strong></summary><div>Why is a bar graph the appropriate plot here?
</div></details><p></p>
</div>
<div id="Q.-2.31" class="Q.">
<p></p><details class="Q. fbx-simplebox fbx-default" open=""><summary><strong>Q. 2.31</strong></summary><div>What do you notice about the shape of the distribution when <span class="math inline">\(p=q=0.5\)</span>
</div></details><p></p>
</div>
<div id="Q.-2.32" class="Q.">
<p></p><details class="Q. fbx-simplebox fbx-default" open=""><summary><strong>Q. 2.32</strong></summary><div>Re-run the analysis with the probability of female as 0.8 and plot the results. How has the shape of the distribution changed?
</div></details><p></p>
</div>
<hr></section></section><section id="the-poisson-distribution" class="level2" data-number="2.2"><h2 data-number="2.2" class="anchored" data-anchor-id="the-poisson-distribution">
<span class="header-section-number">2.2</span> The Poisson distribution</h2>
<p>The Poisson distribution is another probability distribution that describes discrete events that occur in space and/or time. The Poisson distribution is used to model (predict) the distribution of events that are rare, random, and independent. This can include events like earthquakes, storms, or the number of whales spotted on a cruise.</p>
<p>The Poisson distribution takes a single parameter: the mean. If a variable is Poisson distributed, its variance will equal its mean. This is a diagnostic feature of the distribution. The Poisson distribution is a discrete probability distribution, but its parameter, the mean, is continuous (similar to continuous <span class="math inline">\(p\)</span> for the discrete binomial distribution).</p>
<p>Find the formula for the Poisson distribution in <a href="P7_appendix.html" class="quarto-xref"><span>Chapter 7</span></a>.</p>
<p>Here, <span class="math inline">\(\bar{y}\)</span> is the mean, <span class="math inline">\(x\)</span> is the outcome of interest, <span class="math inline">\(e\)</span> is Euler’s number, and <span class="math inline">\(!\)</span> is factorial. Note that here, we use <span class="math inline">\(\bar{y}\)</span> as our stand-in for the population parameter <span class="math inline">\(\lambda = \mu = \sigma\)</span> which defines the Poisson distribution.</p>
<div id="Q.-2.33" class="Q.">
<p></p><details class="Q. fbx-simplebox fbx-default" open=""><summary><strong>Q. 2.33</strong></summary><div>Translate the Poisson formula into an R function by completing the following code.
</div></details><p></p>
</div>
<div class="cell">
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># hint: e^2 = exp(2)</span></span>
<span><span class="co"># hint: 3! = factorial(3)</span></span>
<span><span class="va">calc_poisson_prob</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">y_bar</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Translate the formula here using x and y_bar</span></span>
<span><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="poisson-distributions-by-hand" class="level3" data-number="2.2.1"><h3 data-number="2.2.1" class="anchored" data-anchor-id="poisson-distributions-by-hand">
<span class="header-section-number">2.2.1</span> Poisson distributions by hand</h3>
<p>The first step is to calculate the mean number of observations per unit. This is the Poisson parameter, and is referred to as the <em>rate</em> or as <em>lambda</em> (<span class="math inline">\(\lambda\)</span>). The unit could be spatial (e.g., per <span class="math inline">\(m^2\)</span>) or temporal (e.g., per hour).</p>
<p>Last weekend, I randomly threw a 1<span class="math inline">\(m^2\)</span> quadrat repeatedly on a sandy beach covered in worm casts <a href="#fig-wormcasts" class="quarto-xref">Figure&nbsp;<span>2.3</span></a>. In each quadrat, I counted the number of casts.</p>
<div id="fig-wormcasts" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-wormcasts-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figs/worm_casts.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-wormcasts-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2.3: Worm casts on a sandy beach with 1x1 m quadrats.
</figcaption></figure>
</div>
<p>From these data you can calculate the mean number of observations per unit.</p>
<p>The code below generates a dataframe from which you can determine that the mean number of worms per quadrat is 1.41. We wish to predict the proportion of quadrats that would contain 0, 1, 2, 3, 4, and 5 worms, assuming that the worms are independently distributed across space (i.e., random: one worm’s location has no effect on another worm’s location, and there is no relevant environmental variation).</p>
<p>We will then compare our observations to the expectations from the theoretical Poisson distribution. To do this, we need to know the probability of observing each count, given the mean count per quadrat.</p>
<div class="cell">
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># num_worms is the number of worms per quadrat</span></span>
<span><span class="co"># num_quadrats is number of quadrats that contained each number of worms</span></span>
<span><span class="co"># This dataset is summarised. Raw data might have columns: quadrat_id, num_worms</span></span>
<span><span class="va">worm_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>num_worms<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">5</span>, <span class="fl">6</span><span class="op">)</span>,</span>
<span>                      num_quadrats<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">35</span>, <span class="fl">28</span>, <span class="fl">15</span>, <span class="fl">10</span>, <span class="fl">7</span>, <span class="fl">5</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">worm_df</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  num_worms num_quadrats
1         0           35
2         1           28
3         2           15
4         3           10
5         4            7
6         5            5
7         6            0</code></pre>
</div>
</div>
<p>As the number of worms per quadrat is relatively small, the occurrences are rare enough to be reasonably described by a Poisson distribution if worms occur independently.</p>
<p>From the mean, we can calculate the expected frequency of observing different numbers of worms in any quadrat (assuming the model assumptions are met: What are the assumptions?). The number of worms per quadrat (<span class="math inline">\(y\)</span>) is discrete; it can only take integers greater or equal to zero.</p>
<p>We are often interested in probabilities such as <span class="math inline">\(P(y_i \leq a)\)</span>. That is, the probability that an observation <span class="math inline">\(i\)</span> of the random variable <span class="math inline">\(y\)</span> is less than or equal to <span class="math inline">\(a\)</span>. For example, you may need to calculate <span class="math inline">\(P(y_i \leq 1)\)</span>, which is the probability that a random quadrat (<span class="math inline">\(y_i\)</span>) contains 1 or fewer worm casts (<span class="math inline">\(a\)</span>, an integer value). To be fully complete, we might even write <span class="math inline">\(P(y_i \leq 1 | \bar{y})\)</span>, which acknowledges that we know the (sample) mean.</p>
<p>So, to calculate the probability of obtaining 1 or fewer worms per quadrat, you could start by writing <span class="math inline">\(P(y_i = 0) + P(y_i=1) = \dots\)</span>.</p>
<div id="Q.-2.34" class="Q.">
<p></p><details class="Q. fbx-simplebox fbx-default" open=""><summary><strong>Q. 2.34</strong></summary><div>Use your <code>calc_poisson_prob()</code> function to calculate the expected frequency of 0, 1 &amp; 2 worms per quadrat.
</div></details><p></p>
</div>
<div id="Q.-2.35" class="Q.">
<p></p><details class="Q. fbx-simplebox fbx-default" open=""><summary><strong>Q. 2.35</strong></summary><div>What calculation would you need to conduct to determine <span class="math inline">\(P(y_i \geq 1)\)</span>? What is the theoretical upper limit of the Poisson distribution?
</div></details><p></p>
</div>
<p>R has built-in functions for calculating these, but it is important to know what you are asking them to calculate.</p>
</section><section id="poisson-distributions-using-pois-functions" class="level3" data-number="2.2.2"><h3 data-number="2.2.2" class="anchored" data-anchor-id="poisson-distributions-using-pois-functions">
<span class="header-section-number">2.2.2</span> Poisson distributions using *pois() functions</h3>
<p>You can determine the expected probabilities for each worm count per quadrat once you have determined the mean count of worms per quadrat. Since we have a summarised dataset (i.e., the number of observations <code>num_quadrats</code> for each number of worms <code>num_worms</code>, rather than the raw data with a row for each quadrat), we need to do some calculations. The mean number of worms per quadrat = (total number of worms) / (total number of quadrats).</p>
<div class="cell">
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">worm_df</span><span class="op">$</span><span class="va">num_quadrats</span><span class="op">)</span> <span class="co"># total number of quadrats</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 100</code></pre>
</div>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">worm_df</span><span class="op">$</span><span class="va">num_quadrats</span> <span class="op">*</span> <span class="va">worm_df</span><span class="op">$</span><span class="va">num_worms</span><span class="op">)</span> <span class="co"># total number of worms</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 141</code></pre>
</div>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">lambda_worms</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span><span class="op">(</span><span class="va">worm_df</span>, <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">num_worms</span> <span class="op">*</span> <span class="va">num_quadrats</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">num_quadrats</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">lambda_worms</span> <span class="co"># the mean number of worms per quadrat</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.41</code></pre>
</div>
</div>
<p>Given this, we can find <span class="math inline">\(P(y_i \leq 5)\)</span>: the probability of a random quadrat containing five or fewer worms. With a mean of 1.41 worms per quadrat, <span class="math inline">\(P(y_i \leq 5) = 0.997\)</span> (3 sf). This means that if your data are Poisson distributed with <span class="math inline">\(\lambda = 1.41\)</span>, it is highly unlikely to find more than five worms in a quadrat.</p>
<div id="Q.-2.36" class="Q.">
<p></p><details class="Q. fbx-simplebox fbx-default" open=""><summary><strong>Q. 2.36</strong></summary><div>If the mean number of worms was 3 per quadrat, would you be more or less likely to get five worms in your quadrat?
</div></details><p></p>
</div>
<p>To do these calculation in R, we can use <code><a href="https://rdrr.io/r/stats/Poisson.html">dpois()</a></code> and <code><a href="https://rdrr.io/r/stats/Poisson.html">ppois()</a></code>:</p>
<div class="cell">
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># ?dpois </span></span>
<span><span class="co"># for questions like 'determine P(y_i=a | lambda)'</span></span>
<span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fl">5</span> </span>
<span><span class="va">lambda</span> <span class="op">&lt;-</span> <span class="fl">1.41</span> </span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html">dpois</a></span><span class="op">(</span><span class="va">a</span>, <span class="va">lambda</span><span class="op">)</span> <span class="co"># probability of observing 'a' worms per quadrat: dpois()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.01133859</code></pre>
</div>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># ?ppois</span></span>
<span><span class="co"># for questions like 'determine P(y_i &gt;= a | lambda)</span></span>
<span><span class="fl">1</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html">ppois</a></span><span class="op">(</span><span class="va">a</span><span class="op">-</span><span class="fl">1</span>, <span class="va">lambda</span><span class="op">)</span> <span class="co"># probability of observing &gt;= 'a' worms: ppois()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.01465169</code></pre>
</div>
</div>
<div id="Q.-2.37" class="Q.">
<p></p><details class="Q. fbx-simplebox fbx-default" open=""><summary><strong>Q. 2.37</strong></summary><div>Why is <code>a-1</code> used in the <code><a href="https://rdrr.io/r/stats/Poisson.html">ppois()</a></code> function above? When would you use <code>a</code> instead?
</div></details><p></p>
</div>
<div class="cell">
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html">ppois</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="va">a</span>, <span class="va">lambda</span><span class="op">)</span> <span class="co"># what does 0:a mean? What's another way to make this vector? </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2441433 0.5883853 0.8310759 0.9451405 0.9853483 0.9966869</code></pre>
</div>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">signif</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html">ppois</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="va">a</span>, <span class="va">lambda</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span> <span class="co"># round with ?signif</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.244 0.588 0.831 0.945 0.985 0.997</code></pre>
</div>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html">barplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html">dpois</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="va">a</span>, <span class="va">lambda</span><span class="op">)</span>,</span>
<span>        ylab <span class="op">=</span> <span class="st">"Probability"</span>, xlab <span class="op">=</span> <span class="st">"Number of worms"</span>,</span>
<span>        space <span class="op">=</span> <span class="fl">0.2</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.5</span><span class="op">)</span>, names.arg <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="va">a</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-worm_poisson" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-worm_poisson-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="P2_binomial_poisson_files/figure-html/fig-worm_poisson-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-worm_poisson-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2.4: Poisson probability distribution.
</figcaption></figure>
</div>
</div>
</div>
<div id="Q.-2.38" class="Q.">
<p></p><details class="Q. fbx-simplebox fbx-default" open=""><summary><strong>Q. 2.38</strong></summary><div>Change the code to plot the cumulative probabilities. You will need to use <code><a href="https://rdrr.io/r/stats/Poisson.html">ppois()</a></code> instead of <code><a href="https://rdrr.io/r/stats/Poisson.html">dpois()</a></code> and adjust the y-axis limits (<code>ylim</code>).
</div></details><p></p>
</div>
<div class="cell">
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># create new columns in worm_df for the probabilities</span></span>
<span><span class="va">worm_df</span><span class="op">$</span><span class="va">prob</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html">dpois</a></span><span class="op">(</span><span class="va">worm_df</span><span class="op">$</span><span class="va">num_worms</span>, <span class="va">lambda</span><span class="op">)</span></span>
<span><span class="va">worm_df</span><span class="op">$</span><span class="va">cumul_prob</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html">cumsum</a></span><span class="op">(</span><span class="va">worm_df</span><span class="op">$</span><span class="va">prob</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Make Table 2.1. Use packageName::function() instead of loading with library()</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="va">worm_df</span>, digits<span class="op">=</span><span class="fl">5</span><span class="op">)</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="tbl-worm_table" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-worm_table-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;2.1: Worm cast observations and expected probabilities.
</figcaption><div aria-describedby="tbl-worm_table-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: right;">num_worms</th>
<th style="text-align: right;">num_quadrats</th>
<th style="text-align: right;">prob</th>
<th style="text-align: right;">cumul_prob</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">0.24414</td>
<td style="text-align: right;">0.24414</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">28</td>
<td style="text-align: right;">0.34424</td>
<td style="text-align: right;">0.58839</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">15</td>
<td style="text-align: right;">0.24269</td>
<td style="text-align: right;">0.83108</td>
</tr>
<tr class="even">
<td style="text-align: right;">3</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">0.11406</td>
<td style="text-align: right;">0.94514</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0.04021</td>
<td style="text-align: right;">0.98535</td>
</tr>
<tr class="even">
<td style="text-align: right;">5</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">0.01134</td>
<td style="text-align: right;">0.99669</td>
</tr>
<tr class="odd">
<td style="text-align: right;">6</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.00266</td>
<td style="text-align: right;">0.99935</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<div id="Q.-2.39" class="Q.">
<p></p><details class="Q. fbx-simplebox fbx-default" open=""><summary><strong>Q. 2.39</strong></summary><div>Format the probabilities in <a href="#tbl-worm_table" class="quarto-xref">Table&nbsp;<span>2.1</span></a> to 3 decimal places.
</div></details><p></p>
</div>
<p>If individual probability values (not cumulative probability) are multiplied by the total number of quadrats thrown (n=100), we generate the expected frequency distribution for comparison with the observed results above.</p>
<div id="Q.-2.40" class="Q.">
<p></p><details class="Q. fbx-simplebox fbx-default" open=""><summary><strong>Q. 2.40</strong></summary><div>Write the appropriate code to add a column (called <code>num_quadrats_expected</code>) to <code>worm_df</code> that is the expected number of quadrats (given 100 quadrats total).
</div></details><p></p>
</div>
<p>This is the number of quadrats that you would expect to contain 0, 1, …, 5 worms, given that the mean density of worms is 1.41 per m<span class="math inline">\(^2\)</span>. Note that the number of worms per quadrat is a discrete variable, but you can have non-integer ‘expectations’ (i.e.&nbsp;means).</p>
<div id="Q.-2.41" class="Q.">
<p></p><details class="Q. fbx-simplebox fbx-default" open=""><summary><strong>Q. 2.41</strong></summary><div>Add another column that is the difference in the observed number of quadrats and <code>num_quadrats_expected</code>.
</div></details><p></p>
</div>
<div id="Q.-2.42" class="Q.">
<p></p><details class="Q. fbx-simplebox fbx-default" open=""><summary><strong>Q. 2.42</strong></summary><div>Produce a bar graph of this difference.
</div></details><p></p>
</div>
<hr></section></section><section id="the-poisson-approximation-of-the-binomial-model" class="level2" data-number="2.3"><h2 data-number="2.3" class="anchored" data-anchor-id="the-poisson-approximation-of-the-binomial-model">
<span class="header-section-number">2.3</span> The Poisson approximation of the binomial model</h2>
<p>When the number of trials <span class="math inline">\(n\)</span> is large and the probability of success <span class="math inline">\(p\)</span> is small, the Poisson distribution can be used as an approximation of the binomial distribution. Under these circumstances you can calculate the mean of a variable that has a binomial distribution (<span class="math inline">\(n*p\)</span>) and use that to approximate <span class="math inline">\(y \sim Pois(\lambda = np)\)</span>. Using the Poisson distribution is computationally more efficient in these cases. There is no settled threshold, but as <span class="math inline">\(n\)</span> increases and <span class="math inline">\(p\)</span> decreases, the approximation gets better.</p>
<p>If we set the mean <span class="math inline">\(\lambda = np = 5\)</span>, we can visualize the distributions with different combinations of <span class="math inline">\(n\)</span> and <span class="math inline">\(p\)</span> (e.g., <span class="math inline">\(p=0.5, n=10\)</span>; <span class="math inline">\(p=0.05, n=100\)</span>, etc). We can use this to illustrate how the binomial distribution converges to the Poisson distribution as <span class="math inline">\(n\)</span> gets larger.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb36"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># generate dataframe with probability for 0:16 'successes' from different </span></span>
<span><span class="co"># distributions but where mean is 5.</span></span>
<span><span class="co"># note that in y ~ Binom(10,0.5), probability of &gt;10 successes is zero.</span></span>
<span><span class="va">y_seq</span> <span class="op">&lt;-</span> <span class="fl">0</span><span class="op">:</span><span class="fl">13</span></span>
<span><span class="va">binom_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>y<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="va">y_seq</span>, times<span class="op">=</span><span class="fl">4</span><span class="op">)</span>, <span class="co"># ?rep</span></span>
<span>                   n<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">20</span>, <span class="fl">100</span>, <span class="fl">500</span><span class="op">)</span>, each<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">y_seq</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                   p<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.25</span>, <span class="fl">0.05</span>, <span class="fl">0.01</span><span class="op">)</span>, each<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">y_seq</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>mean<span class="op">=</span><span class="va">n</span><span class="op">*</span><span class="va">p</span>,</span>
<span>           prob<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">dbinom</a></span><span class="op">(</span><span class="va">y_seq</span>, <span class="va">n</span>, <span class="va">p</span><span class="op">)</span>,</span>
<span>           label<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"y ~ Binom("</span>, <span class="va">n</span>, <span class="st">", "</span>, <span class="va">p</span>, <span class="st">")"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">pois_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>y<span class="op">=</span><span class="va">y_seq</span>,</span>
<span>                  n<span class="op">=</span><span class="cn">NA</span>, </span>
<span>                  p<span class="op">=</span><span class="cn">NA</span>,</span>
<span>                  mean<span class="op">=</span><span class="fl">5</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>prob<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html">dpois</a></span><span class="op">(</span><span class="va">y_seq</span>, <span class="va">mean</span><span class="op">)</span>,</span>
<span>           label<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"y ~ Pois("</span>, <span class="va">mean</span>, <span class="st">")"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">distr_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html">bind_rows</a></span><span class="op">(</span><span class="va">binom_df</span>, <span class="va">pois_df</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>label<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">label</span>, levels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">label</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb37"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">distr_df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">y</span>, <span class="va">prob</span>, fill<span class="op">=</span><span class="va">label</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>  <span class="co"># ggplot(data, aes(xVar, yVar))</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>stat<span class="op">=</span><span class="st">"identity"</span>, position<span class="op">=</span><span class="st">"dodge"</span>, colour<span class="op">=</span><span class="st">"grey30"</span><span class="op">)</span> <span class="op">+</span>  <span class="co"># ?geom_bar</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html">scale_fill_brewer</a></span><span class="op">(</span><span class="st">"Distribution"</span>, palette<span class="op">=</span><span class="st">"PuBu"</span><span class="op">)</span> <span class="op">+</span> <span class="co"># from colorbrewer2.org</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x<span class="op">=</span><span class="st">"Number of successes with mean = 5"</span>, y<span class="op">=</span><span class="st">"Probability"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span><span class="op">(</span>breaks<span class="op">=</span><span class="va">y_seq</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_classic</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.85</span>, <span class="fl">0.85</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div id="fig-binom_pois_approx" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-binom_pois_approx-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="P2_binomial_poisson_files/figure-html/fig-binom_pois_approx-1.png" class="img-fluid figure-img" width="960">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-binom_pois_approx-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2.5: Binomial and Poisson distributions converge with larger numbers of events, depending on p.
</figcaption></figure>
</div>
</div>
</div>
<div id="Q.-2.43" class="Q.">
<p></p><details class="Q. fbx-simplebox fbx-default" open=""><summary><strong>Q. 2.43</strong></summary><div>What is the modal value in each of these distributions?
</div></details><p></p>
</div>
<div id="Q.-2.44" class="Q.">
<p></p><details class="Q. fbx-simplebox fbx-default" open=""><summary><strong>Q. 2.44</strong></summary><div>Generate some random numbers from the distributions in <a href="#fig-binom_pois_approx" class="quarto-xref">Figure&nbsp;<span>2.5</span></a> and calculate their mean and variance.
</div></details><p></p>
</div>
<p>Here is <span class="math inline">\(y \sim Pois(\lambda=5)\)</span>:</p>
<div class="cell">
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html">rpois</a></span><span class="op">(</span><span class="fl">10000</span>, <span class="fl">5</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"Mean: "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">signif</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span>, <span class="st">", variance: "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">signif</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">var</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Mean: 5, variance: 4.97"</code></pre>
</div>
</div>
<div id="Q.-2.45" class="Q.">
<p></p><details class="Q. fbx-simplebox fbx-default" open=""><summary><strong>Q. 2.45</strong></summary><div>What do you notice about the mean and variance in the Poisson model?
</div></details><p></p>
</div>
<div id="Q.-2.46" class="Q.">
<p></p><details class="Q. fbx-simplebox fbx-default" open=""><summary><strong>Q. 2.46</strong></summary><div>What do you notice about the mean and variance in the binomial models as <span class="math inline">\(n\)</span> increases and <span class="math inline">\(p\)</span> decreases? When is it more similar to the Poisson? Is this what you expected?
</div></details><p></p>
</div>
<hr></section><section id="conclusions" class="level2" data-number="2.4"><h2 data-number="2.4" class="anchored" data-anchor-id="conclusions">
<span class="header-section-number">2.4</span> Conclusions</h2>
<p>The binomial distribution is a discrete probability distribution that models situations where the outcome of an observation or experiment is binary (i.e., two possibilities) or is coded as such. The binomial model enables us to predict the probability of making our observation or series of independent observations for any given probability of a success (<span class="math inline">\(p\)</span>) in a known number of trials. This enables us to quantify how likely our observation is to have occurred by chance. If the chance of our observation is very low, we can challenge the hypothesis with regard to the probability of success (<span class="math inline">\(p\)</span>) and suggest a different value.</p>
<p>The Poisson distribution is another discrete probability distribution that is used to predict the probability of counts that are rare, independent and randomly distributed with mean = variance = <span class="math inline">\(\lambda\)</span>. The Poisson distribution can be used as an approximation of the binomial distribution where the number of trials (<span class="math inline">\(n\)</span>) is large and the probability of success (<span class="math inline">\(p\)</span>) is small. This approximation is useful as, unlike the Poisson distribution, the binomial calculation requires the handling of massive numbers (from large factorials).</p>


</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("^(?:http:|https:)\/\/\.sz-tim\.quarto\.pub/custom");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
          // target, if specified
          link.setAttribute("target", "_blank");
          if (link.getAttribute("rel") === null) {
            link.setAttribute("rel", "noopener");
          }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./P1_R_recap.html" class="pagination-link" aria-label="R recap">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">R recap</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./P3_normal.html" class="pagination-link" aria-label="Normal distribution">
        <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Normal distribution</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/Sz-Tim/H2DS_Practicals/issues/new" class="toc-action"><i class="bi bi-github"></i>Report an issue</a></li></ul></div></div></div></footer></body></html>