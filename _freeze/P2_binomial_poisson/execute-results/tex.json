{
  "hash": "750eb125aa83a78ec922a53e9edf03ff",
  "result": {
    "engine": "knitr",
    "markdown": "# Binomial and Poisson Distributions {#sec-P2}\n\nWe often wish to determine the probability of events occurring given our current understanding of the processes that are involved. This requires a mathematical description of a theoretical relationship. We refer to this as a statistical model. Models are simplified representations of reality. As George Box said, ‘All models are wrong but some are useful’.\n\nTwo models, the binomial and Poisson distributions, often provide excellent approximations of real-world events. This means that they can be used to determine the likelihood of events or series of events given certain ‘reasonable’ assumptions. In terms of planning, e.g. in the insurance industry, this is extremely useful.\n\nFor example, the binomial or Poisson distributions can be used to answer:\n\n-   How likely is it that four hurricanes hit the US in one season based on historic data?\n-   How likely is it that a ‘50-year’ wave will hit in the next ten years?\n-   Is a river flooding more frequently now than it used to?\n-   What proportion of egg clutches in a fish population will be all males?\n\nThis practical gives you the opportunity to practice using these distributions.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n:::\n\n\n------------------------------------------------------------------------\n\n## The Binomial distribution\n\n### Bernoulli trials\n\nA Bernoulli trial is a single event with a *binary* outcome (i.e., two categories that are mutually exclusive). Binary outcomes include:\n\n-   Alive vs. dead\n-   Reproductive vs. not reproductive\n-   Present vs. absent\n\nOther variables can be re-coded into a binary outcome. For example:\n\n-   Flower colour (blue vs. not blue)\n-   Income ($\\geq$ £100,000 vs. $<$ £100,000)\n\nBy definition, each Bernoulli trial is independent of all previous trials.\n\n::: Q.\nA fair coin has been heads in 99 consecutive flips. What is the probability of heads on the next flip?\n:::\n\nThis is different to asking whether (100 heads) or (99 heads + 1 tails) is more likely in a throw of 100 coins. This is different because each flip is independent.\n\n### The binomial distribution\n\nThe binomial distribution is a discrete probability distribution that applies to a series of Bernoulli trials.\n\nFor example, if a chicken laid 4 eggs and they were all female, you might wonder how likely this was by chance. Here, the outcome can be female or male, and the number of trials is 4: each egg is a ‘trial’ or 'event' with a binary outcome. You may question the assumption that the ratio of female:male was 50:50 and favour an alternative hypothesis that females are more likely. The binomial distribution allows you to quantify the probability of getting $x$ females from $n$ eggs for any given probability $p=P(female)$. That is, we are not restricted to 50:50.\n\nYou need to know two things to use the binomial distribution. These are:\n\n-   The number of trials ($n$, or sometimes $k$)\n-   The probability of success ($p$)\n\nFrom *p*, we can calculate the probability of failure as $q = (1-p)$, since the two probabilities must sum to 1.\n\nThe distribution of a binomially distributed variable $y$ is specified as $y \\sim Binom(n,p)$. We denote $P(x)$ as the probability of getting $x$ successes where $x$ is an integer from $0$ to $n$.\n\nThe **mean of a binomial distribution** is $n*p$. This gives you the *expected* outcome. For example, if $P(female)=0.5$ and $n=4$ eggs the expected number of females is $4*0.5=2$.\n\n### Binomial distributions by hand\n\nWongles always lay two eggs in a clutch but 50% of the eggs are infertile and don't hatch. We are interested in the proportion that we expect to hatch from one clutch (two eggs).\n\n::: Q.\nWhat is the event?\n:::\n\n::: Q.\nWhat is $p$?\n:::\n\n::: Q.\nWhat is the number of trials?\n:::\n\n::: Q.\nHow many possible outcomes are there for a clutch? What are they?\n:::\n\n::: Q.\nWrite down the model specification (with parameters).\n:::\n\n::: Q.\nCalculate the expected proportions of clutches that contain (a) two fertile, (b) two infertile, and (c) one of each. Use a probability tree if needed.\n:::\n\n::: Q.\nUsing the binomial probability mass function from @sec-appendix, calculate the expected proportions for two eggs.\n:::\n\nUnlike Wongles, Oozles always have broods of eight offspring and all of them hatch. We are interested in modelling the probabilities of the number of male and female offspring in these broods of eight eggs.\n\n::: Q.\nWhat is the Bernoulli event?\n:::\n\n::: Q.\nWhat are the theoretical limits to your outcomes (i.e, max numbers of each)?\n:::\n\n::: Q.\nWhat are the possible outcomes? What is the number of possible outcomes?\n:::\n\n::: Q.\nWrite down the model for Oozle egg sex: $y \\sim Binom(n,p)$.\n:::\n\nWe will assume that the probability $p$ of any offspring being female is 0.5 and being male $q$ is 0.5. For the extreme cases where all offspring are one sex, we can use simple probability theory: the probability of getting $n$ females in a brood of size $n$ is equal to $p^n$.\n\n::: Q.\nCalculate the probability of obtaining eight male offspring.\n:::\n\n::: Q.\nWhat is the mean number of females you would expect in Oozle broods?\n:::\n\nIt gets more complicated when you want to know the probability of getting, say, 1 male and 7 females from your clutch of eight eggs.\n\n::: Q.\nGiven that $p=q$, what shape would expect the distribution to be?\n:::\n\n::: Q.\nUse the binomial expression to calculate the probability of obtaining 0, 1, 2, 3, 4, 5, 6, 7 and 8 male offspring (note that the distribution is symmetric).\n:::\n\nIt is much easier, of course, to do this using R.\n\n### Binomial distributions in R\n\nR can calculate probabilities for specific outcomes from a massive array of theoretical probability distributions. The binomial is just one of them.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nnum_female <- 4 # note that 4 is assigned to the variable called num_female\nnum_trials <- 8\np_female <- 0.5\n```\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# for a single probability: y~Binom(n=8, p=0.5) determine P(y_i=4)\ndbinom(num_female, num_trials, p_female) # dbinom(4, 8, 0.5)\n```\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# formatted output just because:\npaste0(\"P(\", num_female, \" female | \", num_trials, \" eggs) = \",\n       dbinom(num_female, num_trials, p_female))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"P(4 female | 8 eggs) = 0.2734375\"\n```\n\n\n:::\n:::\n\n\nThe function `dbinom()` gives the probability of a single outcome.\n\nOften we want to know cumulative probabilities instead. This allows us to answer questions like *\"What is the probability of obtaining \\< 4 females in a brood of 8 eggs?\"* Here, \\<4 equates to the cumulative probability P(0) + P(1) + P(2) + P(3).\n\nFor these calculations, we can use `pbinom(...)` instead of `sum(dbinom(...))`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# pbinom gives the cumulative probability\npaste(\"The cumulative probability is\", \n      max(pbinom(0:num_female - 1, num_trials, p_female)))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"The cumulative probability is 0.36328125\"\n```\n\n\n:::\n:::\n\n\n::: Q.\nWhy do we parameterise `pbinom()` with `num_female-1` rather than `num_female`?\n:::\n\n::: Q.\nWould this change if the question was $P( \\leq 4)$?\n:::\n\n::: Q.\nTake `max` out of the above line and run again. You should see 5 cumulative probabilities. Why is the first cumulative probability zero?\n:::\n\nNote that R has vectorized the calculation, returning the probability for each value in vector from `0:num_female - 1`.\n\n::: Q.\nCalculate P(\\< 4 females \\| 8 eggs) using `dbinom()` instead of `pbinom()`.\n:::\n\nThe above code has a bug in it. You can check what R is doing by running parts of the code:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n0:num_female - 1 # Oops! Is this what you expected?\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] -1  0  1  2  3\n```\n\n\n:::\n\n```{.r .cell-code}\n0:(num_female - 1) # this is actually what we want.\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0 1 2 3\n```\n\n\n:::\n:::\n\n\n::: Q.\nCorrect the code above. Why did this bug have no effect?\n:::\n\n::: Q.\nWhat is the probability of getting 3 females?\n:::\n\n::: Q.\nWhat is the probability of getting 8 females?\n:::\n\n::: Q.\nWhat cumulative probabilities would you need to consider to answer the question *\"What is the probability of getting fewer than three females?\"*\n:::\n\n::: Q.\nReview your model that describes this random process (number of females per eight eggs) that you wrote above: $y \\sim Binom(n, p)$.\n:::\n\n::: Q.\nWhat is the probability of getting \\< 4 females?\n:::\n\n::: Q.\nWhat is the probability of getting $\\leq$ 4 females?\n:::\n\n::: Q.\nWhat is the probability of getting \\> than 8 females?\n:::\n\n::: Q.\nWhat is the probability of getting $\\geq$ than 2 females?\n:::\n\nLet's visualize these distributions in order to better understand them.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Run this, then explore values of p_female\n# Note: 'success' and 'failure' is arbitrary. Just make sure you're calculating\n# what you think. How would you calculate the probabilities for males instead?\nnum_female <- 0:8 \np_female <- 0.5 # what are the limits of p_female?\nprFemale_df <- data.frame(num_female=num_female, \n                          prob=dbinom(num_female, max(num_female), p_female)) \nprFemale_df \n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  num_female       prob\n1          0 0.00390625\n2          1 0.03125000\n3          2 0.10937500\n4          3 0.21875000\n5          4 0.27343750\n6          5 0.21875000\n7          6 0.10937500\n8          7 0.03125000\n9          8 0.00390625\n```\n\n\n:::\n\n```{.r .cell-code}\nbarplot(prFemale_df$prob, names=prFemale_df$num_female, \n        xlab=\"Number of females\", ylab=\"Probability\")\n```\n\n::: {.cell-output-display}\n![Binomial probability distribution](P2_binomial_poisson_files/figure-pdf/fig-binom_dist-1.pdf){#fig-binom_dist fig-pos='H'}\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nprFemale_df$cumul_prob <- cumsum(prFemale_df$prob)\nbarplot(prFemale_df$cumul_prob, names=prFemale_df$num_female, \n        xlab=\"Enter the correct label!\", ylab=\"Enter the correct label!\")\n```\n\n::: {.cell-output-display}\n![Cumulative binomial probability distribution](P2_binomial_poisson_files/figure-pdf/fig-binom_cum_dist-1.pdf){#fig-binom_cum_dist fig-pos='H'}\n:::\n:::\n\n\nTry re-plotting so that the two panels appear side by side (hint: `par(mfrow=c(...))`).\n\nNote $P(y_i=x)$ is read as 'the probability that a random observation y sub i equals x'. Sometimes this includes conditions: $P(y_i=x|n,p)$, which is read as the probability that $y_i$ equals $x$ given $n$ and $p$. You may see $P()$, $Pr()$, $p()$, or $Prob()$, which all mean the same thing.\n\nThe interpretation of $P(y_i=8\\ |\\ n=8,\\ p=0.5) = 0.00391$ is that the probability of 8 female offspring in a clutch of 8 eggs where each egg has 50% probability of being female is 0.00391.\n\nIn other words, if we have 500 broods, each with 8 eggs, we expect $500 * 0.00391 = 1.95 \\approx 2$ broods to be all female. Is there something strange about our Oozle or is it just one of the 2/500 by chance?\n\n::: Q.\nWhy is a bar graph the appropriate plot here?\n:::\n\n::: Q.\nWhat do you notice about the shape of the distribution when $p=q=0.5$\n:::\n\n::: Q.\nRe-run the analysis with the probability of female as 0.8 and plot the results. How has the shape of the distribution changed?\n:::\n\n------------------------------------------------------------------------\n\n## The Poisson distribution\n\nThe Poisson distribution is another probability distribution that describes discrete events that occur in space and/or time. The Poisson distribution is used to model (predict) the distribution of events that are rare, random, and independent. This can include events like earthquakes, storms, or the number of whales spotted on a cruise.\n\nThe Poisson distribution takes a single parameter: the mean. If a variable is Poisson distributed, its variance will equal its mean. This is a diagnostic feature of the distribution. The Poisson distribution is a discrete probability distribution, but its parameter, the mean, is continuous (similar to continuous $p$ for the discrete binomial distribution).\n\nFind the formula for the Poisson distribution in @sec-appendix.\n\nHere, $\\bar{y}$ is the mean, $x$ is the outcome of interest, $e$ is Euler's number, and $!$ is factorial. Note that here, we use $\\bar{y}$ as our stand-in for the population parameter $\\lambda = \\mu = \\sigma$ which defines the Poisson distribution.\n\n::: Q.\nTranslate the Poisson formula into an R function by completing the following code.\n:::\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# hint: e^2 = exp(2)\n# hint: 3! = factorial(3)\ncalc_poisson_prob <- function(x, y_bar) {\n  # Translate the formula here using x and y_bar\n}\n```\n:::\n\n\n\n::: {.cell}\n\n:::\n\n\n### Poisson distributions by hand\n\nThe first step is to calculate the mean number of observations per unit. This is the Poisson parameter, and is referred to as the *rate* or as *lambda* ($\\lambda$). The unit could be spatial (e.g., per $m^2$) or temporal (e.g., per hour).\n\nLast weekend, I randomly threw a 1$m^2$ quadrat repeatedly on a sandy beach covered in worm casts @fig-wormcasts. In each quadrat, I counted the number of casts.\n\n![Worm casts on a sandy beach with 1x1 m quadrats.](figs/worm_casts.png){#fig-wormcasts}\n\nFrom these data you can calculate the mean number of observations per unit.\n\n\n\nThe code below generates a dataframe from which you can determine that the mean number of worms per quadrat is 1.41. We wish to predict the proportion of quadrats that would contain 0, 1, 2, 3, 4, and 5 worms, assuming that the worms are independently distributed across space (i.e., random: one worm's location has no effect on another worm's location, and there is no relevant environmental variation).\n\nWe will then compare our observations to the expectations from the theoretical Poisson distribution. To do this, we need to know the probability of observing each count, given the mean count per quadrat.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# num_worms is the number of worms per quadrat\n# num_quadrats is number of quadrats that contained each number of worms\n# This dataset is summarised. Raw data might have columns: quadrat_id, num_worms\nworm_df <- data.frame(num_worms=c(0, 1, 2, 3, 4, 5, 6),\n                      num_quadrats=c(35, 28, 15, 10, 7, 5, 0))\nworm_df\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  num_worms num_quadrats\n1         0           35\n2         1           28\n3         2           15\n4         3           10\n5         4            7\n6         5            5\n7         6            0\n```\n\n\n:::\n:::\n\n\nAs the number of worms per quadrat is relatively small, the occurrences are rare enough to be reasonably described by a Poisson distribution if worms occur independently.\n\nFrom the mean, we can calculate the expected frequency of observing different numbers of worms in any quadrat (assuming the model assumptions are met: What are the assumptions?). The number of worms per quadrat ($y$) is discrete; it can only take integers greater or equal to zero.\n\nWe are often interested in probabilities such as $P(y_i \\leq a)$. That is, the probability that an observation $i$ of the random variable $y$ is less than or equal to $a$. For example, you may need to calculate $P(y_i \\leq 1)$, which is the probability that a random quadrat ($y_i$) contains 1 or fewer worm casts ($a$, an integer value). To be fully complete, we might even write $P(y_i \\leq 1 | \\bar{y})$, which acknowledges that we know the (sample) mean.\n\nSo, to calculate the probability of obtaining 1 or fewer worms per quadrat, you could start by writing $P(y_i = 0) + P(y_i=1) = \\dots$.\n\n::: Q.\nUse your `calc_poisson_prob()` function to calculate the expected frequency of 0, 1 & 2 worms per quadrat.\n:::\n\n::: Q.\nWhat calculation would you need to conduct to determine $P(y_i \\geq 1)$? What is the theoretical upper limit of the Poisson distribution?\n:::\n\nR has built-in functions for calculating these, but it is important to know what you are asking them to calculate.\n\n### Poisson distributions using \\*pois() functions\n\nYou can determine the expected probabilities for each worm count per quadrat once you have determined the mean count of worms per quadrat. Since we have a summarised dataset (i.e., the number of observations `num_quadrats` for each number of worms `num_worms`, rather than the raw data with a row for each quadrat), we need to do some calculations. The mean number of worms per quadrat = (total number of worms) / (total number of quadrats).\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsum(worm_df$num_quadrats) # total number of quadrats\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 100\n```\n\n\n:::\n\n```{.r .cell-code}\nsum(worm_df$num_quadrats * worm_df$num_worms) # total number of worms\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 141\n```\n\n\n:::\n\n```{.r .cell-code}\nlambda_worms <- with(worm_df, sum(num_worms * num_quadrats) / sum(num_quadrats))\nlambda_worms # the mean number of worms per quadrat\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 1.41\n```\n\n\n:::\n:::\n\n\nGiven this, we can find $P(y_i \\leq 5)$: the probability of a random quadrat containing five or fewer worms. With a mean of 1.41 worms per quadrat, $P(y_i \\leq 5) = 0.997$ (3 sf). This means that if your data are Poisson distributed with $\\lambda = 1.41$, it is highly unlikely to find more than five worms in a quadrat.\n\n::: Q.\nIf the mean number of worms was 3 per quadrat, would you be more or less likely to get five worms in your quadrat?\n:::\n\nTo do these calculation in R, we can use `dpois()` and `ppois()`:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# ?dpois \n# for questions like 'determine P(y_i=a | lambda)'\na <- 5 \nlambda <- 1.41 \ndpois(a, lambda) # probability of observing 'a' worms per quadrat: dpois()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.01133859\n```\n\n\n:::\n\n```{.r .cell-code}\n# ?ppois\n# for questions like 'determine P(y_i >= a | lambda)\n1-ppois(a-1, lambda) # probability of observing >= 'a' worms: ppois()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.01465169\n```\n\n\n:::\n:::\n\n\n::: Q.\nWhy is `a-1` used in the `ppois()` function above? When would you use `a` instead?\n:::\n\n\n::: {.cell}\n\n```{.r .cell-code}\nppois(0:a, lambda) # what does 0:a mean? What's another way to make this vector? \n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.2441433 0.5883853 0.8310759 0.9451405 0.9853483 0.9966869\n```\n\n\n:::\n\n```{.r .cell-code}\nsignif(ppois(0:a, lambda), 3) # round with ?signif\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.244 0.588 0.831 0.945 0.985 0.997\n```\n\n\n:::\n\n```{.r .cell-code}\nbarplot(dpois(0:a, lambda),\n        ylab = \"Probability\", xlab = \"Number of worms\",\n        space = 0.2, ylim = c(0, 0.5), names.arg = 0:a)\n```\n\n::: {.cell-output-display}\n![Poisson probability distribution.](P2_binomial_poisson_files/figure-pdf/fig-worm_poisson-1.pdf){#fig-worm_poisson fig-pos='H'}\n:::\n:::\n\n\n::: Q.\nChange the code to plot the cumulative probabilities. You will need to use `ppois()` instead of `dpois()` and adjust the y-axis limits (`ylim`).\n:::\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# create new columns in worm_df for the probabilities\nworm_df$prob <- dpois(worm_df$num_worms, lambda)\nworm_df$cumul_prob <- cumsum(worm_df$prob)\n```\n:::\n\n\n\n::: {#tbl-worm_table .cell tbl-cap='Worm cast observations and expected probabilities.'}\n\n```{.r .cell-code}\n# Make Table 2.1. Use packageName::function() instead of loading with library()\nknitr::kable(worm_df, digits=5) \n```\n\n::: {.cell-output-display}\n\n\n| num_worms| num_quadrats|    prob| cumul_prob|\n|---------:|------------:|-------:|----------:|\n|         0|           35| 0.24414|    0.24414|\n|         1|           28| 0.34424|    0.58839|\n|         2|           15| 0.24269|    0.83108|\n|         3|           10| 0.11406|    0.94514|\n|         4|            7| 0.04021|    0.98535|\n|         5|            5| 0.01134|    0.99669|\n|         6|            0| 0.00266|    0.99935|\n\n\n:::\n:::\n\n\n::: Q.\nFormat the probabilities in @tbl-worm_table to 3 decimal places.\n:::\n\nIf individual probability values (not cumulative probability) are multiplied by the total number of quadrats thrown (n=100), we generate the expected frequency distribution for comparison with the observed results above.\n\n::: Q.\nWrite the appropriate code to add a column (called `num_quadrats_expected`) to `worm_df` that is the expected number of quadrats (given 100 quadrats total).\n:::\n\nThis is the number of quadrats that you would expect to contain 0, 1, ..., 5 worms, given that the mean density of worms is 1.41 per m$^2$. Note that the number of worms per quadrat is a discrete variable, but you can have non-integer ‘expectations’ (i.e. means).\n\n::: Q.\nAdd another column that is the difference in the observed number of quadrats and `num_quadrats_expected`.\n:::\n\n::: Q.\nProduce a bar graph of this difference.\n:::\n\n------------------------------------------------------------------------\n\n## The Poisson approximation of the binomial model\n\nWhen the number of trials $n$ is large and the probability of success $p$ is small, the Poisson distribution can be used as an approximation of the binomial distribution. Under these circumstances you can calculate the mean of a variable that has a binomial distribution ($n*p$) and use that to approximate $y \\sim Pois(\\lambda = np)$. Using the Poisson distribution is computationally more efficient in these cases. There is no settled threshold, but as $n$ increases and $p$ decreases, the approximation gets better.\n\nIf we set the mean $\\lambda = np = 5$, we can visualize the distributions with different combinations of $n$ and $p$ (e.g., $p=0.5, n=10$; $p=0.05, n=100$, etc). We can use this to illustrate how the binomial distribution converges to the Poisson distribution as $n$ gets larger.\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\n# generate dataframe with probability for 0:16 'successes' from different \n# distributions but where mean is 5.\n# note that in y ~ Binom(10,0.5), probability of >10 successes is zero.\ny_seq <- 0:13\nbinom_df <- tibble(y=rep(y_seq, times=4), # ?rep\n                   n=rep(c(10, 20, 100, 500), each=length(y_seq)),\n                   p=rep(c(0.5, 0.25, 0.05, 0.01), each=length(y_seq))) |>\n    mutate(mean=n*p,\n           prob=dbinom(y_seq, n, p),\n           label=paste0(\"y ~ Binom(\", n, \", \", p, \")\"))\npois_df <- tibble(y=y_seq,\n                  n=NA, \n                  p=NA,\n                  mean=5) |>\n    mutate(prob=dpois(y_seq, mean),\n           label=paste0(\"y ~ Pois(\", mean, \")\"))\ndistr_df <- bind_rows(binom_df, pois_df) |>\n  mutate(label=factor(label, levels=unique(label)))\n```\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nggplot(distr_df, aes(y, prob, fill=label)) +  # ggplot(data, aes(xVar, yVar))\n  geom_bar(stat=\"identity\", position=\"dodge\", colour=\"grey30\") +  # ?geom_bar\n  scale_fill_brewer(\"Distribution\", palette=\"PuBu\") + # from colorbrewer2.org\n  labs(x=\"Number of successes with mean = 5\", y=\"Probability\") +\n  scale_x_continuous(breaks=y_seq) +\n  theme_classic() + \n  theme(legend.position=c(0.85, 0.85))\n```\n\n::: {.cell-output-display}\n![Binomial and Poisson distributions converge with larger numbers of events, depending on p.](P2_binomial_poisson_files/figure-pdf/fig-binom_pois_approx-1.pdf){#fig-binom_pois_approx fig-pos='H'}\n:::\n:::\n\n\n::: Q.\nWhat is the modal value in each of these distributions?\n:::\n\n::: Q.\nGenerate some random numbers from the distributions in @fig-binom_pois_approx and calculate their mean and variance.\n:::\n\nHere is $y \\sim Pois(\\lambda=5)$:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ny <- rpois(10000, 5)\npaste0(\"Mean: \", signif(mean(y), 3), \", variance: \", signif(var(y), 3))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"Mean: 5.03, variance: 5.02\"\n```\n\n\n:::\n:::\n\n\n::: Q.\nWhat do you notice about the mean and variance in the Poisson model?\n:::\n\n::: Q.\nWhat do you notice about the mean and variance in the binomial models as $n$ increases and $p$ decreases? When is it more similar to the Poisson? Is this what you expected?\n:::\n\n------------------------------------------------------------------------\n\n## Conclusions\n\nThe binomial distribution is a discrete probability distribution that models situations where the outcome of an observation or experiment is binary (i.e., two possibilities) or is coded as such. The binomial model enables us to predict the probability of making our observation or series of independent observations for any given probability of a success ($p$) in a known number of trials. This enables us to quantify how likely our observation is to have occurred by chance. If the chance of our observation is very low, we can challenge the hypothesis with regard to the probability of success ($p$) and suggest a different value.\n\nThe Poisson distribution is another discrete probability distribution that is used to predict the probability of counts that are rare, independent and randomly distributed with mean = variance = $\\lambda$. The Poisson distribution can be used as an approximation of the binomial distribution where the number of trials ($n$) is large and the probability of success ($p$) is small. This approximation is useful as, unlike the Poisson distribution, the binomial calculation requires the handling of massive numbers (from large factorials).\n",
    "supporting": [
      "P2_binomial_poisson_files\\figure-pdf"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {
      "knitr": [
        "{\"type\":\"list\",\"attributes\":{},\"value\":[]}"
      ]
    },
    "preserve": null,
    "postProcess": false
  }
}